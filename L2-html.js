"use strict";var L2={};L2.compile=function(){throw new Error("compiler not included")},function(){function r(r){try{var e=window[r],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(n){return!1}}if("object"==typeof window&&"object"==typeof window.document){var e=document.getElementsByTagName("title");0!==e.length&&e[0].getAttribute("data-L2-ide")?L2.runningIn="object"==typeof global&&"function"==typeof global.require?"nw":"br":L2.runningIn="wp"}else{if("object"!=typeof global)throw new Error("cannot determine environment that L2 is running in");L2.runningIn="function"==typeof global.require?"nc":"nd"}L2.webStorage={localStorage:r("localStorage"),sessionStorage:r("sessionStorage")}}(),"nw"===L2.runningIn||"nd"===L2.runningIn||"nc"===L2.runningIn?(L2.node_fs=require("fs"),L2.node_path=require("path"),L2.node_es=require("event-stream"),L2.node_zlib=require("zlib"),L2.node_concat=require("concat-stream"),L2.node_stringdecode=require("string_decoder").StringDecoder,L2.node_request=require("request"),L2.node_rimraf=require("rimraf"),L2.node_readChunk=require("read-chunk"),"nw"!==L2.runningIn&&(global.L2=L2)):L2.modules={loaded:{}},Function.prototype.toString=function(){return"function"},String.prototype.replaceStr=function(r,e){return this.replace(r,String(e))},String.prototype.matchMod=function(r){var e=this.match(r);if(e){if(r instanceof RegExp&&r.global)return new L2.ArJSA(e);var t=new L2.ArJSA([e[0],e.index,e.input]);return t.rk={match:0,position:1,input:2},t.z=!0,1!==e.length&&(t.v[3]=new L2.Box(new L2.ArJSA(e.slice(1))),t.r=4,t.rk.sub=3),t}return new L2.ArJSA([])},Number.prototype.angle=function(r){return Math.atan2(r,this)},Number.prototype.mag=function(r){return Math.sqrt(this*this+r*r)},Date.prototype.getDayName=function(){return L2.aux.dayNames[this.getDay()]},Date.prototype.getUTCDayName=function(){return L2.aux.dayNames[this.getUTCDay()]},Date.prototype.getMonthName=function(){return L2.aux.monthNames[this.getMonth()]},Date.prototype.getUTCMonthName=function(){return L2.aux.monthNames[this.getUTCMonth()]},Date.prototype.UTCaddDate=function(r,e){return this.addDate(r,e,!0)},Date.prototype.subDate=function(r,e){return this.addDate(-r,e)},Date.prototype.UTCsubDate=function(r,e){return this.addDate(-r,e,!0)},Date.prototype.addDate=function(r,e,t){"number"!=typeof r&&(r=+r),void 0===e?e="day":"week"===e&&(r*=7,e="day");var n=L2.aux.timeUnits[e];if(!n)throw new Error("invalid time unit");return t&&(n="UTC"+n),new Date(new Date(this)["set"+n](r+this["get"+n]()))},L2.errorMsg={opNotAvail:"operator not available in this environment",setOnly:"setter operator only, ':' required",noKeyWithE:"cannot use 'key' with suffix 'E'",shapeMismatch:"shape mismatch",dupKey:"will result in duplicate key",undefAsKey:"undefined not a valid key, use 'undefined' if necessary"},L2.ops={maxEnt:1e7},L2.assert={nonNegInt:function(r){if(Math.round(r)!=r||r<0||!isFinite(r))throw new Error("non-negative integer expected");return r},posInt:function(r){if(Math.round(r)!=r||r<=0||!isFinite(r))throw new Error("positive integer expected");return r},validShAr:function(r){var e,t=1,n=r.v.length;if(n>3||0===n)throw new Error("shape table must have 1, 2 or 3 entries");for(var i=0;i<n;i++){if(e=r.v[i],Math.round(e)!=e||e<0||!isFinite(e))throw new Error("non-negative integer expected");t*=e}return L2.assert.maxEnt(t),t},maxEnt:function(r){if(r>L2.ops.maxEnt)throw new Error("number of entries will exceed maximum: "+L2.ops.maxEnt.toExponential())},func:function(r){if("function"!=typeof r)throw new Error("function expected");return r},node:function(){if(!L2.node_path)throw new Error("operator not available in this environment")},notBr:function(){if("br"===L2.runningIn)throw new Error("operator not available in this environment")},webStorage:function(r){var e=r?"sessionStorage":"localStorage";if(!L2.webStorage[e])throw new Error(e+" not available");return window[e]},dataMatrix:function(r){if(1!==r.p||0===r.c)throw new Error("matrix with at least 1 column expected")},homogType:function(r,e){var t,n,i;if(0===r.r)return"undefined";if(void 0===e?(t=0,i=r.v.length-1):(t=r.r*e,i=t+r.r-1),n=typeof r.v[t],"string"===n||"boolean"===n){for(t++;t<=i;t++)if(typeof r.v[t]!==n)throw new Error(n+" expected")}else if("number"===n)for(;t<=i;t++){if("number"!=typeof r.v[t])throw new Error("number expected");if(isNaN(r.v[t]))throw new Error("NaN not permitted")}else{if(!(r.v[t]instanceof Date))throw new Error("string, number, date or boolean expected");for(n="date";t<=i;t++){if(!(r.v[t]instanceof Date))throw new Error("date expected");if(isNaN(r.v[t]))throw new Error("valid date expected")}}return n}},L2.tab=function(r){return r instanceof L2.Ar?r:new L2.ArJSA([r])},L2.sca=function(r){return r instanceof L2.Ar?r.v[0]:r},L2.tabIfBox=function(r){return r instanceof L2.Box?r._contents_:r},L2.boxIfTab=function(r){return r instanceof L2.Ar?new L2.Box(r):r},L2.aux={prt:function(r){return r},prtDebug:function(){throw new Error(L2.errorMsg.opNotAvail)},jsToStr:function(){throw new Error(L2.errorMsg.opNotAvail)},plot:function(){throw new Error(L2.errorMsg.opNotAvail)},clear:function(){throw new Error(L2.errorMsg.opNotAvail)},onLoad:function(){throw new Error(L2.errorMsg.opNotAvail)},ajaxGet:function(){throw new Error(L2.errorMsg.opNotAvail)},ajaxLoad:function(){throw new Error(L2.errorMsg.opNotAvail)},vg:function(){throw new Error(L2.errorMsg.opNotAvail)},absPath:function(r){return L2.node_path?L2.node_path.resolve(r):r},L2_JS:function(r){var e=L2.node_fs.readFileSync(r,"utf8");e=L2.compile(e,r),r=r.slice(0,-3)+".js",L2.node_fs.writeFileSync(r,e)},expandDim:{r:"row",c:"column",p:"page"},lettersJSA:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],lettersJSO:{a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7,i:8,j:9,k:10,l:11,m:12,n:13,o:14,p:15,q:16,r:17,s:18,t:19,u:20,v:21,w:22,x:23,y:24,z:25,A:26,B:27,C:28,D:29,E:30,F:31,G:32,H:33,I:34,J:35,K:36,L:37,M:38,N:39,O:40,P:41,Q:42,R:43,S:44,T:45,U:46,V:47,W:48,X:49,Y:50,Z:51},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],timeUnits:{year:"FullYear",month:"Month",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",milli:"Milliseconds"},light:function(){return L2.sc.pairMult("xGridColor","#ccc","yGridColor","#ccc","borderColor","#555","fontColor","#111")},vgSpec:function(r,e,t,n,i,o,s,h,f){function a(r){return void 0===r?void 0:r.toString()}var v={data:null,mark:e,encoding:{x:{field:a(t),type:a(n)},y:{field:a(i),type:a(o)}},config:{background:"white"}};if(arguments.length>6){if(void 0===s)throw new Error(L2.errorMsg.undefAsKey);v.encoding[s]={field:a(h),type:a(f)}}return v=L2.aux.fromJSON(JSON.stringify(v)),v.v[v.rk.data]=new L2.Box(L2.sc.pair("values",new L2.Box(r))),v},typeL2:function(r){var e=typeof r;if("object"!==e)return e;if(r instanceof Date)return"date";if(r instanceof RegExp)return"regex";if(r instanceof L2.Box)return"box";throw new Error("not an L2 type")},isEmpty:function(r){if("object"!=typeof r)return!0;for(var e in r)return!1;return!0},uniqueJSA:function(r){for(var e=1,t=r.length;e<t;e++)for(var n=0;n<e;n++)if(r[e]===r[n])return!1;return!0},uniqueJSA_strEq:function(r){for(var e,t={},n=0,i=r.length;n<i;n++){if(e=r[n],t[e])return!1;t[e]=1}return!0},countProps:function(r){var e=0;for(var t in r)e++;return e},mutExProps:function(r,e){for(var t in e)if(t in r)return!1;return!0},keyValFlip:function(r){var e={};for(var t in r)e[r[t]]=t;return e},boxCopy:function(r){if(r instanceof L2.Box)return new L2.Box(new L2.ArCopy(r._contents_,(!0),"deep"));throw new Error("cannot copy a scalar unless it is a box")},shuffle:function(r){var e,t=new Array(r);t[0]=0;for(var n=1;n<r;n++)e=Math.floor(Math.random()*(n+1)),t[n]=t[e],t[e]=n;return t},mod:function(r,e){return(r%e+e)%e},validSfx:function(r,e){if(r=(""+r).toLowerCase(),"r"===r||"c"===r||"p"===r||"e"===r&&e)return r;throw new Error("invalid suffix")},emptyToNull:function(r){var e=function(r,e,t,n,i,o){return o||i?",null":e||t?"null,null":void 0!==n?"null":r};return r.replace(/"[^"\\]*(?:\\.[^"\\]*)*"|(^\s*,\s*$)|(^\s*,\s*(?=,))|(^\s*(?=,))|(,\s*$)|(,\s*(?=,))/gm,e)},exportStringCSV:function(r){return'"'+r.replace(/\\/g,"\\\\").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\"/g,'\\"')+'"'},jsc:function(r){return console.log(r),r},basicType:function(r){var e=typeof r;return"string"===e||"number"===e||"boolean"===e||"undefined"===e?r:""+r},ternary:function(r,e,t){var n,i,o,s,h,f=1,a=1,v=1;if(i=e instanceof L2.Ar,i&&(a=e.v.length,1===a&&(e=e.v[0],i=void 0)),o=t instanceof L2.Ar,o&&(v=t.v.length,1===v&&(t=t.v[0],o=void 0)),n=r instanceof L2.Ar,n&&(f=r.v.length,1!==f||1===a&&1===v||(r=r.v[0],n=void 0)),n&&i&&(r.r!==e.r||r.c!==e.c||r.p!==e.p))throw new Error(L2.errorMsg.shapeMismatch);if(n&&o&&(r.r!==t.r||r.c!==t.c||r.p!==t.p))throw new Error(L2.errorMsg.shapeMismatch);if(i&&o&&(e.r!==t.r||e.c!==t.c||e.p!==t.p))throw new Error(L2.errorMsg.shapeMismatch);if(n)if(s=new L2.ArShell(r),s.v=new Array(s.r*s.c*s.p),i)if(o)for(h=0;h<f;h++)s.v[h]=r.v[h]?e.v[h]:t.v[h];else for(h=0;h<f;h++)s.v[h]=r.v[h]?e.v[h]:t;else if(o)for(h=0;h<f;h++)s.v[h]=r.v[h]?e:t.v[h];else for(h=0;h<f;h++)s.v[h]=r.v[h]?e:t;else if(i)if(s=new L2.ArSh(new L2.ArToSh(e),(void 0),(!0)),o)for(h=0;h<a;h++)s.v[h]=r?e.v[h]:t.v[h];else for(h=0;h<a;h++)s.v[h]=r?e.v[h]:t;else if(o)for(s=new L2.ArSh(new L2.ArToSh(t),(void 0),(!0)),h=0;h<v;h++)s.v[h]=r?e:t.v[h];else s=new L2.ArJSA([r?e:t]);return s},ternarySca:function(r,e,t){return r?e:t},tpSca:function(r,e){if(void 0!==e&&(e=e.toLowerCase(),"rcp"!==e&&"rpc"!==e&&"crp"!==e&&"cpr"!==e&&"prc"!==e&&"pcr"!==e))throw new Error("invalid permutation");return new L2.ArJSA([r])},testError:function(r,e){try{r()}catch(t){if(t.message!==e)throw new Error("unexpected error message");return}throw new Error("expected error, but none thrown")},specChar:function(r){var e={"&":"&amp;",";":"&semi;","<":"&lt;"," ":"&nbsp;","\n":"<br>","\t":"&nbsp;&nbsp;"};return r.replace(/[&;< \n\t]/g,function(r){return e[r]})},fromJSON:function(r){function e(r){var t,n,i,o,s,h,f;if(Array.isArray(r)){for(s=r.length,L2.assert.maxEnt(s),i=new Array(s),t=0;t<s;t++)h=r[t],i[t]=null===h?void 0:"object"==typeof h?new L2.Box(e(h)):h;return new L2.ArJSA(i)}if("object"==typeof r){i=[],o={},n=0;for(t in r)h=r[t],i[n]=null===h?void 0:"object"==typeof h?new L2.Box(e(h)):h,o[t]=n++;return L2.assert.maxEnt(i.length),f=new L2.ArJSA(i),f.z=!0,f.rk=o,f}throw new Error("argument must be an object or array")}return e(JSON.parse(r))},openIfBox:function(r){return r instanceof L2.Box?r._contents_:new L2.ArJSA([r])},normal:function(r,e){var t,n,i,o,s,h,f;for(f=new L2[e?"ArSh":"Ar"](r),n=f.v.length,t=0;t<n;)i=2*Math.random()-1,o=2*Math.random()-1,s=i*i+o*o,s>0&&s<1&&(h=Math.sqrt(-2*Math.log(s)/s),f.v[t++]=i*h,t<n&&(f.v[t++]=o*h));return f},colInd:function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r._getInd(e.v[i],"c");if(!L2.aux.uniqueJSA_strEq(n))throw new Error("duplicate in argument");return new L2.ArJSA(n)},polyData:function(r){function e(r){if(1!==r.p||2!==r.c)throw new Error("2-column matrix expected")}var t=r.v;if(0===t.length){if(1!==r.p||1!==r.c&&2!==r.c)throw new Error("vector or 2-column matrix expected");return 1===r.c?"boxed":"unboxed"}if(t[0]instanceof L2.Box){if(1!==r.c||1!==r.p)throw new Error("vector expected");e(t[0]._contents_);for(var n=1;n<r.r;n++){if(!(t[n]instanceof L2.Box))throw new Error("box expected");e(t[n]._contents_)}return"boxed"}return e(r),"unboxed"},modulePost:function(r){return r instanceof L2.Ar?r:L2.fromJS(r)},modifyPath:function(r,e){var t,n,i,o;if(L2.node_path)for(t=0,n=r.v.length;t<n;t++)i=L2.node_path.resolve(r.v[t]+"/node_modules"),o=process.mainModule.paths.indexOf(i),0===o&&e||(o!==-1&&process.mainModule.paths.splice(o,1),e&&(process.mainModule.paths=[i].concat(process.mainModule.paths)))}},L2.fromJS=function(r){var e,t,n,i,o,s,h,f;if(Array.isArray(r)){for(o=r.length,L2.assert.maxEnt(o),n=new Array(o),e=0;e<o;e++)if(s=r[e],h=typeof s,"number"===h||"string"===h||"boolean"===h)n[e]=s;else{if(void 0===s||null===s)continue;"function"===h||s instanceof Date||s instanceof RegExp?n[e]=s.toString():n[e]=new L2.Box(L2.fromJS(s))}return new L2.ArJSA(n)}if("object"==typeof r){n=[],i={},t=0;for(e in r)s=r[e],h=typeof s,"number"===h||"string"===h||"boolean"===h?n[t]=s:void 0===s||null===s?n[t]=void 0:"function"===h||s instanceof Date||s instanceof RegExp?n[t]=s.toString():n[t]=new L2.Box(L2.fromJS(s)),i[e]=t++;return L2.assert.maxEnt(n.length),f=new L2.ArJSA(n),f.z=!0,f.rk=i,f}throw new Error("argument must be an object or array")},L2.toJS=function(r){var e,t,n,i,o;if(r.rk&&1===r.c&&1===r.p){n={};for(e in r.rk)i=r.v[r.rk[e]],o=typeof i,"number"===o||"string"===o||"boolean"===o?n[e]=i:void 0===i?n[e]=null:i instanceof L2.Box?n[e]=L2.toJS(i._contents_):n[e]=i.toString()}else for(t=r.v.length,n=new Array(t),e=0;e<t;e++)i=r.v[e],o=typeof i,"number"===o||"string"===o||"boolean"===o?n[e]=i:void 0===i?n[e]=null:i instanceof L2.Box?n[e]=L2.toJS(i._contents_):n[e]=i.toString();return n},L2.ws=function(r){if("br"===L2.runningIn)throw new Error("cannot create WebSocket in browser version of L2");var e=function(){return"WebSocket (internal type)"};return e._ws_=new WebSocket(r),e._ws_.sendWrap=function(r){return e._ws_.send(r),e},e._ws_.closeWrap=function(r,t){return e._ws_.close(r,t),e},e._ws_.receive=function(r,t){if("function"!=typeof t)throw new Error("function expected");if("open"===r)e._ws_.onopen=function(){t()};else if("data"===r)e._ws_.onmessage=function(r){if("string"!=typeof r.data)throw new Error("data from server must be a string");t(r.data)};else if("error"===r)e._ws_.onerror=function(){t()};else{if("close"!==r)throw new Error("'open', 'data', 'error' or 'close' expected");e._ws_.onclose=function(r){t(r.code,r.reason,r.wasClean)}}return e},e},L2.pf={math:{"^":Math.pow,"^^":function(r,e){return r*Math.pow(10,e)},"><":Math.max,"<>":Math.min,"%%":L2.aux.mod},noArg:{tic:function(){return L2.aux.ticGo="br"===L2.runningIn||"wp"===L2.runningIn?performance.now():process.hrtime(),0},toc:function(){if("br"===L2.runningIn||"wp"===L2.runningIn)return Math.round(performance.now()-L2.aux.ticGo);var r=process.hrtime(L2.aux.ticGo);return Math.round((1e9*r[0]+r[1])/1e6)},wd:function(){return L2.assert.node(),process.cwd()}},ew:{js:function(r){return L2.compile(""+r)},sqrt:Math.sqrt,abs:Math.abs,round:Math.round,floor:Math.floor,ceil:Math.ceil,exp:Math.exp,log:Math.log,log10:function(r){return Math.log(r)/Math.LN10},log2:function(r){return Math.log(r)/Math.LN2},sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh,cosh:Math.cosh,tanh:Math.tanh,asinh:Math.asinh,acosh:Math.acosh,atanh:Math.atanh,cbrt:Math.cbrt,fac:function(r){if(L2.assert.nonNegInt(r),r<=1)return 1;for(var e=+r;r>2;)e*=--r;return e},num:function(r){return+r},str:function(r){return""+r},bool:function(r){return!!r},date:function(r){return new Date(r)},isNum:function(r){return"number"==typeof r},isInt:function(r){return Math.round(r)===r&&isFinite(r)},isFin:function(r){return"number"==typeof r&&isFinite(r)},isNaN:function(r){return"number"==typeof r&&isNaN(r)},isStr:function(r){return"string"==typeof r},isBool:function(r){return"boolean"==typeof r},isFunc:function(r){return"function"==typeof r},isReg:function(r){return r instanceof RegExp},isDate:function(r){return r instanceof Date},isBox:function(r){return r instanceof L2.Box},isFile:function(r){L2.assert.node();try{return L2.node_fs.statSync(L2.aux.absPath(r)).isFile()}catch(e){return!1}},isDir:function(r){L2.assert.node();try{return L2.node_fs.statSync(L2.aux.absPath(r)).isDirectory()}catch(e){return!1}},type:L2.aux.typeL2,unbox:function(r){return r instanceof L2.Box?r._contents_.v[0]:r},box:function(r){return r instanceof L2.Box?r:new L2.Box(new L2.ArJSA([r]))}},reg:function(r,e){if(void 0!==e){if(/[^gim]/.test(e))throw new Error("invalid flag");return new RegExp(r,e)}return new RegExp(r)}},L2.ge={},L2.ge.isBasic=function(r){return!(r instanceof L2.Ar||r instanceof L2.Box)},L2.ge.isBasic.sig={arg:[3],rtn:!1,min:1},L2.ge.isNil=function(r){return void 0===r||r instanceof L2.Ar&&1===r.v.length&&void 0===r.v[0]},L2.ge.isNil.sig={arg:[3],rtn:!1,min:1},L2.ge.isVec=function(r){return!(r instanceof L2.Ar)||1===r.c&&1===r.p},L2.ge.isVec.sig={arg:[3],rtn:!1,min:1},L2.ge.isMat=function(r){return!(r instanceof L2.Ar&&1!==r.p)},L2.ge.isMat.sig={arg:[3],rtn:!1,min:1},L2.ge.isDict=function(r){return!!(r instanceof L2.Ar&&r.rk&&1===r.c&&1===r.p)},L2.ge.isDict.sig={arg:[3],rtn:!1,min:1},L2.ge.error=function(r){var e=new Error(r instanceof L2.Ar?r.v[0]:r);throw e._user_=!0,e},L2.ge.error.sig={arg:[3],rtn:!1,min:0},L2.ge.equal=function(r,e){var t,n,i,o,s,h,f;if(h=["r","c","p"],r instanceof L2.Ar){if(!(e instanceof L2.Ar))return!1;if(r.r!==e.r||r.c!==e.c||r.p!==e.p)return!1;if(r.z||e.z){for(i=0;i<3;i++){if(f=h[i]+"k",o=r[f],s=e[f],!!o!=!!s)return!1;if(o)for(t in o)if(o[t]!==s[t])return!1}if(!!r.e!=!!e.e)return!1;if(r.e&&(r.e.t!==e.e.t||r.e.i!==e.e.i||r.e.rl!==e.e.rl||r.e.cl!==e.e.cl||r.e.pl!==e.e.pl||!!r.e.rf!=!!e.e.rf||!!r.e.cf!=!!e.e.cf||!!r.e.pf!=!!e.e.pf||!!r.e.ef!=!!e.e.ef))return!1}for(t=0,n=r.v.length;t<n;t++)if(r.v[t]instanceof L2.Box){if(!(e.v[t]instanceof L2.Box&&L2.ge.equal(r.v[t]._contents_,e.v[t]._contents_)))return!1}else if(r.v[t]!==e.v[t])return!1}else{if(e instanceof L2.Ar)return!1;if(r instanceof L2.Box){if(!(e instanceof L2.Box&&L2.ge.equal(r._contents_,e._contents_)))return!1}else if(r!==e)return!1}return!0},L2.ge.equal.sig={arg:[3,3],rtn:!1,min:2},L2.ge.assert=function(r,e){var t,n,i,o,s,h,f;if(h=["r","c","p"],r instanceof L2.Ar){if(!(e instanceof L2.Ar))throw new Error("(assert) table and scalar");if(r.r!==e.r)throw new Error("(assert) number of rows not equal");if(r.c!==e.c)throw new Error("(assert) number of columns not equal");if(r.p!==e.p)throw new Error("(assert) number of pages not equal");if(r.z||e.z){for(i=0;i<3;i++){if(f=h[i]+"k",o=r[f],s=e[f],!!o!=!!s)throw new Error("(assert) only one argument has "+L2.aux.expandDim[h[i]]+" keys");if(o)for(t in o)if(o[t]!==s[t])throw new Error("(assert) "+L2.aux.expandDim[h[i]]+" keys not equal or not in same order")}if(!!r.e!=!!e.e)throw new Error("(assert) only one argument has a non-keys extra");if(r.e){if(r.e.t!==e.e.t)throw new Error("(assert) titles not equal");if(r.e.i!==e.e.i)throw new Error("(assert) info not equal");if(r.e.rl!==e.e.rl)throw new Error("(assert) row labels not equal");if(r.e.cl!==e.e.cl)throw new Error("(assert) column labels not equal");if(r.e.pl!==e.e.pl)throw new Error("(assert) page labels not equal");if(!!r.e.rf!=!!e.e.rf)throw new Error("(assert) only one argument has row key formatting");if(!!r.e.cf!=!!e.e.cf)throw new Error("(assert) only one argument has column key formatting");if(!!r.e.pf!=!!e.e.pf)throw new Error("(assert) only one argument has page key formatting");if(!!r.e.ef!=!!e.e.ef)throw new Error("(assert) only one argument has entry formatting")}}for(t=0,n=r.v.length;t<n;t++)if(r.v[t]instanceof L2.Box){if(!(e.v[t]instanceof L2.Box&&L2.ge.equal(r.v[t]._contents_,e.v[t]._contents_)))throw new Error("(assert) entries at index "+t+" not equal")}else if(r.v[t]!==e.v[t])throw new Error("(assert) entries at index "+t+" not equal")}else{if(e instanceof L2.Ar)throw new Error("(assert) scalar and table");if(r instanceof L2.Box){if(!(e instanceof L2.Box&&L2.ge.equal(r._contents_,e._contents_)))throw new Error("(assert) scalars not equal")}else if(r!==e)throw new Error("(assert) scalars not equal")}return!0},L2.ge.assert.sig={arg:[3,3],rtn:!1,min:2},L2.ge.cd=function(r){return L2.assert.node(),process.chdir(L2.aux.absPath(r instanceof L2.Ar?r.v[0]:r)),process.cwd()},L2.ge.cd.sig={arg:[3],rtn:!1,min:1},L2.ge["delete"]=function(r){if(L2.assert.node(),r instanceof L2.Ar)for(var e=0;e<r.v.length;e++)L2.node_fs.unlinkSync(L2.aux.absPath(r.v[e]));else L2.node_fs.unlinkSync(L2.aux.absPath(r));return!0},L2.ge["delete"].sig={arg:[3],rtn:!1,min:1},L2.ge.forget=function(){if(L2.node_path)for(var r=Object.keys(require.cache),e=0,t=r.length;e<t;e++)delete require.cache[r[e]]},L2.ge.forget.sig={arg:[],rtn:!1,min:0},L2.ge.path=function(){if(L2.node_path){var r=process.mainModule.paths.length;L2.assert.maxEnt(r);for(var e=new Array(r),t=0;t<r;t++)e[t]=""+process.mainModule.paths[t];return new L2.ArJSA(e)}return new L2.ArJSA([])},L2.ge.path.sig={arg:[],rtn:!0,min:0},L2.sc={},L2.sc.apnd=function(r,e,t){var n=new L2.ArJSA([e,t]);return"c"===r?(n.r=1,n.c=2):"p"===r&&(n.r=1,n.p=2),n},L2.sc.range=function(r,e,t,n,i){var o,s,h,f,a,v,c=typeof r;if(typeof e!==c)throw new Error("first two arguments must be same type");if("number"===c){if(!isFinite(r)||!isFinite(e))throw new Error("start or end not finite");if(void 0===t)t=1;else if(t=+(+t).toFixed(14),0===t||!isFinite(t))throw new Error("invalid step size");if(r=+r.toFixed(14),e=+e.toFixed(14),r<e&&t<0||r>e&&t>0)throw new Error("stepping in wrong direction");for(s=Math.floor(Math.abs((e-r)/t).toFixed(14))+1,L2.assert.maxEnt(s),h=new L2.Ar(s,(void 0),(!0)),o=0;o<s;o++)h.v[o]=r+o*t}else{if(void 0===t)t=1;else if(t=+t,Math.round(t)!==t||0===t||!isFinite(t))throw new Error("invalid step size");if("string"===c){if(r=L2.aux.lettersJSO[r],e=L2.aux.lettersJSO[e],void 0===r||void 0===e)throw new Error("start or end not a letter");if(r<e&&t<0||r>e&&t>0)throw new Error("stepping in wrong direction");for(s=Math.floor(Math.abs((e-r)/t))+1,h=new L2.Ar(s,(void 0),(!0)),o=0;o<s;o++)h.v[o]=L2.aux.lettersJSA[r+o*t]}else{if(!(r instanceof Date))throw new Error("first argument must be number, string or date");if(a=r.getTime(),v=e.getTime(),!isFinite(a)||!isFinite(v))throw new Error("start or end invalid");if(f=[],r=new Date(r),a<v){if(t<0)throw new Error("stepping in wrong direction");do f.push(r),r=r.addDate(t,n,i);while(r.getTime()<=v)}else if(a>v){if(t>0)throw new Error("stepping in wrong direction");do f.push(r),r=r.addDate(t,n,i);while(r.getTime()>=v)}else f.push(r);h=new L2.ArJSA(f)}}return h},L2.sc.pair=function(r,e){if(void 0===r)throw new Error(L2.errorMsg.undefAsKey);var t=new L2.ArJSA([e]);return t.rk={},t.rk[r]=0,t.z=!0,t},L2.sc.pairNone=function(){var r=new L2.ArJSA([]);return r.rk={},r.z=!0,r},L2.sc.pairMult=function(){var r,e=arguments.length;if(1===e){if(r=arguments[0].v,e=r.length,e%2===1)throw new Error("odd number of entries")}else r=arguments;L2.assert.maxEnt(e/2);var t,n,i,o=0,s=new Array(e/2);for(n=1;n<e;n+=2)s[o++]=r[n];for(i=new L2.ArJSA(s),i.rk={},o=0,n=0;n<e;n+=2){if(t=r[n],void 0===t)throw new Error(L2.errorMsg.undefAsKey);if(t in i.rk)throw new Error("keys not unique");i.rk[t]=o++}return i.z=!0,i},L2.sc.split=function(r,e,t){var n;return void 0===e&&(e=""),3===arguments.length?(L2.assert.nonNegInt(t),n=r.split(e,t)):n=r.split(e),L2.assert.maxEnt(n.length),new L2.ArJSA(n)},L2.sc.loadCSV=function(r,e,t){var n,i,o,s,h,f,a,v,c,u,l,w,p,L,g,d,m;if(2===arguments.length)if("name"===e)o=!0;else{if("miss"!==e)throw new Error("argument must be 'name' or 'miss'");s=!0}else if(3===arguments.length){if(!("name"===e&&"miss"===t||"miss"===e&&"name"===t))throw new Error("arguments must be 'name' and 'miss'");o=!0,s=!0}if(i=L2.sc.read(r),""===i.trim())throw new Error("no data in file\n"+r);for(s&&(i=L2.aux.emptyToNull(i)),n=i.split("\n");0===n[n.length-1].trim().length;)n.pop();try{a=JSON.parse("["+n[0]+"]")}catch(A){throw new Error("invalid data\n"+r+":1")}for(v=a.length,h=n.length,f=o?h-1:h,p=f*v,L2.assert.maxEnt(p),L=new Array(p),l=0,u=o?1:0;u<h;u++,l++){try{m=0===u?a:JSON.parse("["+n[u]+"]")}catch(A){throw new Error("invalid data\n"+r+":"+(u+1))}if(m.length!==v)throw new Error("wrong number of fields\n"+r+":"+(u+1));for(w=0;w<v;w++){if(g=m[w],d=typeof g,null===g)g=void 0;else if("number"!==d&&"boolean"!==d&&"string"!==d)throw new Error("invalid type - must be number, string or boolean\n"+r+":"+(u+1));L[l+f*w]=g}}if(c=new L2.ArJSA(L),c.r=f,c.c=v,o){for(u=0;u<v;u++)if(d=typeof a[u],"number"!==d&&"boolean"!==d&&"string"!==d)throw new Error("invalid key\n"+r+":1");c["key:"]("c",void 0,new L2.ArJSA(a))}return c},L2.sc.load=function(r){if(".L2T"!==r.slice(-4).toUpperCase())throw new Error("file extension must be '.L2T'");return L2.sc.deserial(L2.sc.read(r))},L2.sc.deserial=function(r){function e(r){var t,n,i;for(t=0,n=r.v.length;t<n;t++)i=typeof r.v[t],"number"!==i&&"boolean"!==i&&"string"!==i&&(null===r.v[t]?r.v[t]=void 0:r.v[t]=new L2.Box(e(r.v[t]._contents_)));return r}return new L2.ArCopy(e(JSON.parse(r)),(!0),"deep")},L2.sc.storageKey=function(r,e){var t=L2.assert.webStorage(r).key(e);return null===t?void 0:t},L2.sc._dPush=function(r,e,t){if(r instanceof L2.Box)return r._contents_._dPush(e,t);throw new Error("dictionary expected")},L2.sc._dEnt=function(r,e){if(r instanceof L2.Box)return r._contents_._dEnt(e);throw new Error("dictionary expected")},L2.sc.read=function(r){return L2.assert.node(),L2.node_fs.readFileSync(L2.aux.absPath(r),"utf8")},L2.sc.write=function(r,e,t){if(L2.assert.node(),3===arguments.length){if("append"!==t)throw new Error("argument must be 'append'");L2.node_fs.appendFileSync(L2.aux.absPath(e),r)}else L2.node_fs.writeFileSync(L2.aux.absPath(e),r);return!0},L2.sc.readLine=function(r,e){L2.assert.node(),L2.assert.func(e);for(var t,n,i="",o=0,s=0,h=new L2.node_stringdecode("utf8"),f=16384,a=new Buffer(f),v=-1,c=!1,u=!0,l=!0,w=L2.node_fs.openSync(r,"r");u;){for(l=!0;l;)v=i.indexOf("\n",o),v!==-1?(s=v,l=!1):c?(s=i.length,l=!1):(t=L2.node_fs.readSync(w,a,0,f,null),c=t!==f,i+=h.write(a.slice(0,t)));o<i.length?(e(i.substring(o,s+1)),o=s+1,o>=f&&(n=o/f,i=i.substring(f),o-=f,s-=f)):u=!1}L2.node_fs.closeSync(w)},L2.sc.stream=function(r,e){L2.assert.node(),L2.assert.func(e);var t=L2.node_fs.createReadStream(r),n=L2.node_concat(function(r){e(r.toString())});".gz"===r.slice(-3)?t.pipe(L2.node_zlib.createGunzip()).pipe(n):t.pipe(n)},L2.sc.streamChunk=function(r,e,t,n){L2.assert.node(),L2.assert.func(t);var i,o,s;i=L2.node_fs.createReadStream(r),s=L2.node_es.split(e),".gz"===r.slice(-3)&&(o=L2.node_zlib.createGunzip()),void 0===n?n=function(){}:L2.assert.func(n),o?i.pipe(o).pipe(s).pipe(L2.node_es.through(t,n)):i.pipe(s).pipe(L2.node_es.through(t,n))},L2.sc.http=function(r,e,t,n){L2.assert.node(),L2.assert.func(e);var i=L2.node_concat(function(r){e(r.toString())});".gz"===r.slice(-3)?L2.node_request.get(r).auth(String(t),String(n),!1).pipe(L2.node_zlib.createGunzip()).pipe(i):L2.node_request.get(r).auth(String(t),String(n),!1).pipe(i)},L2.sc.httpChunk=function(r,e,t,n,i,o){L2.assert.node(),L2.assert.func(t),void 0===n?n=function(){}:L2.assert.func(n);var s=L2.node_es.split(e);".gz"===r.slice(-3)?L2.node_request.get(r).auth(String(i),String(o),!1).pipe(L2.node_zlib.createGunzip()).pipe(s).pipe(L2.node_es.through(t,n)):L2.node_request.get(r).auth(String(i),String(o),!1).pipe(s).pipe(L2.node_es.through(t,n))},L2.sc.httpBasic=function(r,e,t,n){L2.assert.node(),L2.assert.func(e),L2.node_request.get(r,function(r,t,n){if(r)throw r;if(200!=t.statusCode)throw new Error("status code: "+t.statusCode+", message: "+t.statusMessage);e(n)}).auth(String(t),String(n),!1)},L2.sc.httpGet=function(r,e,t,n,i){L2.assert.node(),void 0===t?t=function(){}:L2.assert.func(t),L2.node_request.get(r).auth(String(n),String(i),!1).pipe(L2.node_fs.createWriteStream(e)).on("finish",t)},L2.sc.gzip=function(r,e,t,n){L2.assert.node(),void 0===n?n=function(){}:L2.assert.func(n),L2.node_fs.createReadStream(e).pipe(L2.node_zlib[r?"createGunzip":"createGzip"]()).pipe(L2.node_fs.createWriteStream(t)).on("finish",n)},L2.sc.ls=function(r){return L2.assert.node(),r=arguments.length?L2.aux.absPath(r):process.cwd(),new L2.ArJSA(L2.node_fs.readdirSync(r))},L2.sc.about=function(r){L2.assert.node(),r=arguments.length?L2.aux.absPath(r):process.cwd();var e,t,n,i,o,s=L2.node_fs.readdirSync(r),h=s.length,f=new L2.ArSh(new L2.ArJSA([h,6,1]),(void 0),(!0));for(f["key:"]("c",void 0,new L2.ArJSA(["base","ext","byte","item","mod","born"])),f["key:"]("r",void 0,new L2.ArJSA(s)),i=0;i<h;i++){o=i,n=r+"/"+s[i],t=L2.node_path.extname(n),f.v[o]=L2.node_path.basename(n,t),f.v[o+=h]=t;try{e=L2.node_fs.statSync(n),f.v[o+=h]=e.size,f.v[o+=h]=e.isFile()?"file":e.isDirectory()?"dir":"other",f.v[o+=h]=e.mtime,f.v[o+=h]=e.birthtime}catch(a){}}return f},L2.sc.unwrap=function(r){if(r instanceof L2.Box)return r._contents_;throw new Error("box expected")},L2.sc.normal=function(){for(var r,e,t;;)if(r=2*Math.random()-1,e=2*Math.random()-1,t=r*r+e*e,t>0&&t<1)return r*Math.sqrt(-2*Math.log(t)/t)},L2.Box=function(r){this._contents_=r},L2.Box.prototype.toString=function(){return"box"},L2.Ar=function(r,e,t){if(t||(r=+r,L2.assert.nonNegInt(r),L2.assert.maxEnt(r)),this.v=new Array(r),void 0!==e)for(var n=0;n<r;n++)this.v[n]=e;this.r=r,this.c=this.p=1,this.z=!1},L2.ArSh=function(r,e,t){var n=r.v.length;t||L2.assert.validShAr(r),this.r=+r.v[0],n>1?(this.c=+r.v[1],n>2?this.p=+r.v[2]:this.p=1):this.c=this.p=1;var i=this.r*this.c*this.p;if(this.v=new Array(i),void 0!==e)for(var o=0;o<i;o++)this.v[o]=e;this.z=!1},L2.ArSh.prototype=L2.Ar.prototype,L2.ArFast=function(r,e,t){this.v=new Array(r*e*t),this.r=r,this.c=e,this.p=t,this.z=!1},L2.ArFast.prototype=L2.Ar.prototype,L2.ArJSA=function(r){this.v=r,this.r=r.length,this.c=this.p=1,this.z=!1},L2.ArJSA.prototype=L2.Ar.prototype,L2.ArJSA_Sh=function(r,e,t,n){this.v=r,this.r=e,this.c=t,this.p=n,this.z=!1},L2.ArJSA_Sh.prototype=L2.Ar.prototype,L2.ArToSh=function(r){this.v=[r.r,r.c,r.p],this.r=3,this.c=this.p=1,this.z=!1},L2.ArToSh.prototype=L2.Ar.prototype,L2.ArTp=function(r,e){var t;if(void 0!==e){if(e=e.toLowerCase(),"rcp"!==e&&"rpc"!==e&&"crp"!==e&&"cpr"!==e&&"prc"!==e&&"pcr"!==e)throw new Error("invalid permutation")}else e="crp";var n=e[0],i=e[1],o=e[2];if(this.r=r[n],this.c=r[i],this.p=r[o],r.z){if(r.e&&(this.e={},r.e.t&&(this.e.t=r.e.t),r.e.i&&(this.e.i=r.e.i),r.e[n+"l"]&&(this.e.rl=r.e[n+"l"]),r.e[i+"l"]&&(this.e.cl=r.e[i+"l"]),r.e[o+"l"]&&(this.e.pl=r.e[o+"l"]),r.e.ef&&(this.e.ef=r.e.ef),r.e[n+"f"]&&(this.e.rf=r.e[n+"f"]),r.e[i+"f"]&&(this.e.cf=r.e[i+"f"]),r.e[o+"f"]&&(this.e.pf=r.e[o+"f"])),t=r[n+"k"]){this.rk={};for(l in t)this.rk[l]=t[l]}if(t=r[i+"k"]){this.ck={};for(l in t)this.ck[l]=t[l]}if(t=r[o+"k"]){this.pk={};for(l in t)this.pk[l]=t[l]}this.z=!0}else this.z=!1;this.v=new Array(r.v.length);for(var s={r:1,c:r.r,p:r.r*r.c},h=s[n],f=s[i],a=s[o],v=0,c=0;c<r[o];c++)for(var u=0;u<r[i];u++)for(var l=0;l<r[n];l++)this.v[v++]=r.v[l*h+u*f+c*a]},L2.ArTp.prototype=L2.Ar.prototype,L2.ArSc=function(r){this.v=[r],this.r=this.c=this.p=1,this.z=!1},L2.ArSc.prototype=L2.Ar.prototype,L2.ArCopy=function(r,e,t){if(arguments.length>=3&&"deep"!==t)throw new Error("argument must be 'deep'");var n;if(this.r=r.r,this.c=r.c,this.p=r.p,e&&r.z){if(r.e){this.e={};for(n in r.e)this.e[n]=r.e[n]}if(r.rk){this.rk={};for(n in r.rk)this.rk[n]=r.rk[n]}if(r.ck){this.ck={};for(n in r.ck)this.ck[n]=r.ck[n]}if(r.pk){this.pk={};for(n in r.pk)this.pk[n]=r.pk[n]}this.z=!0}else this.z=!1;var i=r.v.length;if(this.v=new Array(i),t)for(n=0;n<i;n++)r.v[n]instanceof L2.Box?this.v[n]=new L2.Box(new L2.ArCopy(r.v[n]._contents_,(!0),"deep")):this.v[n]=r.v[n];else for(n=0;n<i;n++)this.v[n]=r.v[n]},L2.ArCopy.prototype=L2.Ar.prototype,L2.ArShell=function(r,e){var t;if(this.r=r.r,this.c=r.c,this.p=r.p,r.z){if(r.e){this.e={};for(t in r.e)this.e[t]=r.e[t]}if(r.rk&&"r"!==e){this.rk={};for(t in r.rk)this.rk[t]=r.rk[t]}if(r.ck&&"c"!==e){this.ck={};for(t in r.ck)this.ck[t]=r.ck[t]}if(r.pk&&"p"!==e){this.pk={};for(t in r.pk)this.pk[t]=r.pk[t]}this.z=!0}else this.z=!1},L2.ArShell.prototype=L2.Ar.prototype,L2.P=L2.Ar.prototype,L2.P["title:"]=function(r){if(void 0===r)this.e&&(delete this.e.t,L2.aux.isEmpty(this.e)&&delete this.e);else{if(r=""+r,""===r)throw new Error("empty string not permitted");this.e=this.e||{},this.e.t=r,this.z=!0}return this},L2.P["title:"].sig={
arg:[1],rtn:!0,min:1,dim:0},L2.P.title=function(){if(this.e)return this.e.t},L2.P.title.sig={arg:[],rtn:!1,min:0,dim:0},L2.P["info:"]=function(r){if(void 0===r)this.e&&(delete this.e.i,L2.aux.isEmpty(this.e)&&delete this.e);else{if(r=""+r,""===r)throw new Error("empty string not permitted");this.e=this.e||{},this.e.i=r,this.z=!0}return this},L2.P["info:"].sig={arg:[1],rtn:!0,min:1,dim:0},L2.P.info=function(){if(this.e)return this.e.i},L2.P.info.sig={arg:[],rtn:!1,min:0,dim:0},L2.P["fmt:"]=function(r,e){if(void 0===e)this.e&&(delete this.e[r+"f"],L2.aux.isEmpty(this.e)&&delete this.e);else{if("function"!=typeof e)throw new Error("function expected");this.e=this.e||{},this.e[r+"f"]=function(r){return L2.sca(e(r))},this.z=!0}return this},L2.P["fmt:"].sig={arg:[1],rtn:!0,min:1,dim:2},L2.P.fmt=function(r){if(this.e)return this.e[r+"f"]},L2.P.fmt.sig={arg:[],rtn:!1,min:0,dim:2},L2.P["label:"]=function(r,e){if(void 0===e)this.e&&(delete this.e[r+"l"],L2.aux.isEmpty(this.e)&&delete this.e);else{if(e=""+e,""===e)throw new Error("empty string not permitted");this.e=this.e||{},this.e[r+"l"]=e,this.z=!0}return this},L2.P["label:"].sig={arg:[1],rtn:!0,min:1,dim:1},L2.P.label=function(r){if(this.e)return this.e[r+"l"]},L2.P.label.sig={arg:[],rtn:!1,min:0,dim:1},L2.P["key:"]=function(r,e,t){var n,i,o,s,h,f,a,v,c=L2.ge.isNil(e);if(L2.ge.isNil(t)){if(!c)throw new Error("invalid combination of arguments");delete this[r+"k"]}else if(c){if(t instanceof L2.Ar){if(t.v.length!==this[r])throw new Error("number of keys not equal to number of "+L2.aux.expandDim[r]+"s");if(0===this[r])this[r+"k"]={};else{for(s=t.v.length,i={},o=0;o<s;o++){if(n=t.v[o],void 0===n)throw new Error(L2.errorMsg.undefAsKey);if(n in i)throw new Error("keys not unique");i[n]=o}this[r+"k"]=i}}else{if(1!==this[r])throw new Error("number of keys not equal to number of "+L2.aux.expandDim[r]+"s");i={},i[t]=0,this[r+"k"]=i}this.z=!0}else{if(i=this[r+"k"],!i)throw new Error("table has no "+L2.aux.expandDim[r]+" keys");if(e instanceof L2.Ar&&(h=e.v.length),void 0===h||1===h){if(e=""+(h?e.v[0]:e),t instanceof L2.Ar){if(1!==t.v.length)throw new Error("last two arguments do not have same number of entries");t=""+t.v[0]}else t=""+t;if("number"!=typeof i[e])throw new Error("key does not exist");if(e===t)return this;if("number"==typeof i[t])throw new Error(L2.errorMsg.dupKey);i[t]=i[e],delete i[e]}else{if(a={},v={},t instanceof L2.Ar&&(f=t.v.length),h!==f)throw new Error("last two arguments do not have same number of entries");if(0===f)return this;for(o in i)a[o]=i[o];for(o=0;o<h;o++){if(void 0===e.v[o]||void 0===t.v[o])throw new Error(L2.errorMsg.undefAsKey);if(v[t.v[o]]=n=a[e.v[o]],"number"!=typeof n)throw new Error("key does not exist or duplicate in keys to change");delete a[e.v[o]]}for(o=0;o<h;o++){if("number"==typeof a[t.v[o]])throw new Error(L2.errorMsg.dupKey);a[t.v[o]]=v[t.v[o]]}this[r+"k"]=a}}return this},L2.P["key:"].sig={arg:[3,3],rtn:!0,min:1,dim:1},L2.P.key=function(r){var e=this[r+"k"];if(e){var t=new Array(this[r]);for(var n in e)t[e[n]]=n;return new L2.ArJSA(t)}return new L2.ArJSA([void 0])},L2.P.key.sig={arg:[],rtn:!0,min:0,dim:1},L2.P["extra:"]=function(r){if(void 0!==r)throw new Error("must pass undefined as second argument");return this.z&&(delete this.rk,delete this.ck,delete this.pk,delete this.e,this.z=!1),this},L2.P["extra:"].sig={arg:[1],rtn:!0,min:1,dim:0},L2.P.extra=function(r){throw new Error(L2.errorMsg.setOnly)},L2.P.extra.sig={arg:[1],rtn:!0,min:1,dim:0},L2.P.morph=function(r){var e,t,n=new L2.ArCopy(this,(!1)),i=n.v.length;if(r instanceof L2.Ar){if(e=r.v.length,t=L2.assert.validShAr(r),t!==i)throw new Error("number of entries cannot change");n.r=+r.v[0],e>1?(n.c=+r.v[1],e>2?n.p=+r.v[2]:n.p=1):n.c=n.p=1}else{if(i!=r)throw new Error("number of entries cannot change");n.r=i,n.c=n.p=1}return n},L2.P.morph.sig={arg:[3],rtn:!0,min:1,dim:0},L2.P.sqz=function(){var r,e=new L2.ArCopy(this,(!0)),t="",n="";return 1!==this.r?n+="r":t+="r",1!==this.c?n+="c":t+="c",1!==this.p?n+="p":t+="p",r=n+t,"rcp"===r?e:new L2.ArTp(e,r)},L2.P.sqz.sig={arg:[],rtn:!0,min:0,dim:0},L2.P.flip=function(r){var e,t,n,i=new L2.ArShell(this),o=0,s=i.r*i.c,h=r+"k";if(i[h])for(e in this[h])i[h][e]=i[r]-this[h][e]-1;if(i.v=new Array(this.v.length),"r"===r)for(n=0;n<i.p;n++)for(t=0;t<i.c;t++)for(e=i.r-1;e>=0;e--)i.v[o++]=this.v[e+t*i.r+n*s];else if("c"===r)for(n=0;n<i.p;n++)for(t=i.c-1;t>=0;t--)for(e=0;e<i.r;e++)i.v[o++]=this.v[e+t*i.r+n*s];else for(n=i.p-1;n>=0;n--)for(t=0;t<i.c;t++)for(e=0;e<i.r;e++)i.v[o++]=this.v[e+t*i.r+n*s];return i},L2.P.flip.sig={arg:[],rtn:!0,min:0,dim:1},L2.P.shuf=function(r){var e,t,n,i,o=new L2.ArShell(this),s=0,h=o.r*o.c,f=r+"k",a=L2.aux.shuffle(o[r]);if(o[f]){for(i=new Array(o[r]),e=0;e<o[r];e++)i[a[e]]=e;for(e in this[f])o[f][e]=i[this[f][e]]}if(o.v=new Array(this.v.length),"r"===r)for(n=0;n<o.p;n++)for(t=0;t<o.c;t++)for(e=0;e<o.r;e++)o.v[s++]=this.v[a[e]+t*o.r+n*h];else if("c"===r)for(n=0;n<o.p;n++)for(t=0;t<o.c;t++)for(e=0;e<o.r;e++)o.v[s++]=this.v[e+a[t]*o.r+n*h];else for(n=0;n<o.p;n++)for(t=0;t<o.c;t++)for(e=0;e<o.r;e++)o.v[s++]=this.v[e+t*o.r+a[n]*h];return o},L2.P.shuf.sig={arg:[],rtn:!0,min:0,dim:1},L2.P.shift=function(r,e){if(void 0===e)e=1;else if(Math.round(e)!=e||!isFinite(e))throw new Error("integer expected");e=-+e;var t,n,i,o=new L2.ArShell(this),s=0,h=o.r*o.c,f=r+"k";if(o[f])for(t in this[f])o[f][t]=L2.aux.mod(this[f][t]-e,o[r]);if(o.v=new Array(this.v.length),"r"===r)for(i=0;i<o.p;i++)for(n=0;n<o.c;n++)for(t=0;t<o.r;t++)o.v[s++]=this.v[L2.aux.mod(t+e,o.r)+n*o.r+i*h];else if("c"===r)for(i=0;i<o.p;i++)for(n=0;n<o.c;n++)for(t=0;t<o.r;t++)o.v[s++]=this.v[t+L2.aux.mod(n+e,o.c)*o.r+i*h];else for(i=0;i<o.p;i++)for(n=0;n<o.c;n++)for(t=0;t<o.r;t++)o.v[s++]=this.v[t+n*o.r+L2.aux.mod(i+e,o.p)*h];return o},L2.P.shift.sig={arg:[1],rtn:!0,min:0,dim:1},L2.P.rep=function(r,e){if(e=void 0===e?2:+L2.assert.nonNegInt(e),this[r+"k"])throw new Error("cannot repeat along dimension with keys");var t=this.v.length*e;L2.assert.maxEnt(t);var n=new L2.ArShell(this);n.v=new Array(t);var i,o,s,h,f=0,a=n.r*n.c;if("r"===r)for(s=0;s<n.p;s++)for(o=0;o<n.c;o++)for(h=0;h<e;h++)for(i=0;i<n.r;i++)n.v[f++]=this.v[i+o*n.r+s*a];else if("c"===r)for(s=0;s<n.p;s++)for(h=0;h<e;h++)for(o=0;o<n.c;o++)for(i=0;i<n.r;i++)n.v[f++]=this.v[i+o*n.r+s*a];else for(h=0;h<e;h++)for(s=0;s<n.p;s++)for(o=0;o<n.c;o++)for(i=0;i<n.r;i++)n.v[f++]=this.v[i+o*n.r+s*a];return n[r]*=e,n},L2.P.rep.sig={arg:[1],rtn:!0,min:0,dim:1},L2.P.to=function(r){var e;if(this.r!==r.r){if(1!==this.r)throw new Error("will only repeat along singleton dimensions");e=this.rep("r",r.r)}if(this.c!==r.c){if(1!==this.c)throw new Error("will only repeat along singleton dimensions");e=e?e.rep("c",r.c):this.rep("c",r.c)}if(this.p!==r.p){if(1!==this.p)throw new Error("will only repeat along singleton dimensions");e=e?e.rep("p",r.p):this.rep("p",r.p)}return e||(e=new L2.ArCopy(this,(!0))),e},L2.P.to.sig={arg:[2],rtn:!0,min:1,dim:0},L2.P["slice:"]=function(r,e,t,n){if(e=this._getInd(e,r),void 0===t)t=e-1;else if(t=this._getInd(t,r),t<e)throw new Error("end index less than start index");if("r"===r&&(this.c!==n.c||this.p!==n.p)||"c"===r&&(this.r!==n.r||this.p!==n.p)||"p"===r&&(this.r!==n.r||this.c!==n.c))throw new Error(L2.errorMsg.shapeMismatch);var i,o,s,h,f,a,v,c=r+"k",u=0;if(0===e&&t===this[r]-1){if(this[c]){if(!n[c])throw new Error("second table has no "+L2.aux.expandDim[r]+" keys");f={};for(o in n[c])f[o]=n[c][o];this[c]=f}for(i=n.v.length,a=new Array(i),o=0;o<i;o++)a[o]=n.v[o];this.v=a,this[r]=n[r]}else{var l=t-e+1,w=this.r*this.c,p=n.r*n.c;if("r"===r)for(v=(this.r-l+n.r)*this.c*this.p,L2.assert.maxEnt(v),a=new Array(v),h=0;h<this.p;h++)for(s=0;s<this.c;s++){for(o=0;o<e;o++)a[u++]=this.v[o+s*this.r+h*w];for(o=0;o<n.r;o++)a[u++]=n.v[o+s*n.r+h*p];for(o=t+1;o<this.r;o++)a[u++]=this.v[o+s*this.r+h*w]}else if("c"===r)for(v=this.r*(this.c-l+n.c)*this.p,L2.assert.maxEnt(v),a=new Array(v),h=0;h<this.p;h++){for(s=0;s<e;s++)for(o=0;o<this.r;o++)a[u++]=this.v[o+s*this.r+h*w];for(s=0;s<n.c;s++)for(o=0;o<this.r;o++)a[u++]=n.v[o+s*n.r+h*p];for(s=t+1;s<this.c;s++)for(o=0;o<this.r;o++)a[u++]=this.v[o+s*this.r+h*w]}else{for(v=w*(this.p-l+n.p),L2.assert.maxEnt(v),a=new Array(v),s=e*w,o=0;o<s;o++)a[u++]=this.v[o];for(s=n.v.length,o=0;o<s;o++)a[u++]=n.v[o];for(s=this.v.length,o=(t+1)*w;o<s;o++)a[u++]=this.v[o]}if(this[c]){if(!n[c])throw new Error("second table has no "+L2.aux.expandDim[r]+" keys");f={};for(o in this[c])i=this[c][o],i<e?f[o]=i:i>t&&(f[o]=i+n[r]-l);for(o in n[c]){if(o in f)throw new Error(L2.errorMsg.dupKey);f[o]=n[c][o]+e}this[c]=f}this.v=a,this[r]=this[r]-l+n[r]}return this},L2.P["slice:"].sig={arg:[1,1,2],rtn:!0,min:2,dim:1},L2.P.slice=function(r,e,t,n){if(4===arguments.length&&"cut"!==n)throw new Error("argument must be 'cut'");var i=new L2.ArShell(this),o=r+"k";if(e=this._getInd(e,r),void 0===t)return i.v=[],i[o]&&(i[o]={}),i[r]=0,i;if(t=this._getInd(t,r),t<e)throw new Error("end index less than start index");var s,h,f,a,v,c=i.r*i.c,u=0,l=t-e+1;if(i[o])if(i[o]={},n)for(f in this[o])s=this[o][f],s>=e&&s<=t?(i[o][f]=s-e,delete this[o][f]):s>t&&(this[o][f]=s-l);else for(f in this[o])s=this[o][f],s>=e&&s<=t&&(i[o][f]=s-e);if(0===this.v.length)i.v=[],n&&(h=[]);else if("r"===r){for(i.v=new Array(l*i.c*i.p),v=0;v<i.p;v++)for(a=0;a<i.c;a++)for(f=e;f<=t;f++)i.v[u++]=this.v[f+a*i.r+v*c];if(n)for(u=0,h=new Array(this.v.length-i.v.length),v=0;v<i.p;v++)for(a=0;a<i.c;a++){for(f=0;f<e;f++)h[u++]=this.v[f+a*i.r+v*c];for(f=t+1;f<i.r;f++)h[u++]=this.v[f+a*i.r+v*c]}}else if("c"===r){for(i.v=new Array(i.r*l*i.p),v=0;v<i.p;v++)for(a=e;a<=t;a++)for(f=0;f<i.r;f++)i.v[u++]=this.v[f+a*i.r+v*c];if(n)for(u=0,h=new Array(this.v.length-i.v.length),v=0;v<i.p;v++){for(a=0;a<e;a++)for(f=0;f<i.r;f++)h[u++]=this.v[f+a*i.r+v*c];for(a=t+1;a<i.c;a++)for(f=0;f<i.r;f++)h[u++]=this.v[f+a*i.r+v*c]}}else{for(i.v=new Array(c*l),a=(t+1)*c,f=e*c;f<a;f++)i.v[u++]=this.v[f];if(n){for(u=0,h=new Array(this.v.length-i.v.length),a=e*c,f=0;f<a;f++)h[u++]=this.v[f];for(a=this.v.length,f=(t+1)*c;f<a;f++)h[u++]=this.v[f]}}return i[r]=l,n&&(this.v=h,this[r]-=l),i},L2.P.slice.sig={arg:[1,1,1],rtn:!0,min:1,dim:1},L2.P["diag:"]=function(r){var e,t,n,i,o,s,h;if(i=this.r,o=this.p,s=Math.min(i,this.c),h=i*this.c,r instanceof L2.Ar){if(1!==r.v.length){if(r.v.length!==s*o)throw new Error(L2.errorMsg.shapeMismatch);for(n=0,t=0;t<o;t++)for(e=0;e<s;e++,n++)this.v[e+e*i+t*h]=r.v[n];return this}r=r.v[0]}for(t=0;t<o;t++)for(e=0;e<s;e++)this.v[e+e*i+t*h]=r;return this},L2.P["diag:"].sig={arg:[3],rtn:!0,min:1,dim:0},L2.P.diag=function(){var r,e,t,n,i,o,s,h,f;for(i=this.r,o=this.p,s=Math.min(i,this.c),h=i*this.c,n=new Array(s*o),t=0,e=0;e<o;e++)for(r=0;r<s;r++,t++)n[t]=this.v[r+r*i+e*h];if(f=new L2.ArShell(this,"c"),f.r=s,f.c=1,f.v=n,f.z&&(f.e&&(delete f.e.cl,delete f.e.cf,delete f.e.t,delete f.e.i,L2.aux.isEmpty(f.e)&&delete f.e),f.rk&&s<i))for(r in f.rk)f.rk[r]>=s&&delete f.rk[r];return f},L2.P.diag.sig={arg:[],rtn:!0,min:0,dim:0},L2.P["use:"]=function(r,e){if(void 0===e)return this;if(e instanceof L2.Ar&&e[r+"k"]){if(1===e.v.length&&("r"===r&&(1!==this.c||1!==this.p)||"c"===r&&(1!==this.r||1!==this.p)||"p"===r&&(1!==this.r||1!==this.c)))throw new Error(L2.errorMsg.shapeMismatch);this._oneDimSetAr(r,e.key(r),e)}return this},L2.P["use:"].sig={arg:[3],rtn:!0,min:1,dim:1},L2.P.use=function(r,e){throw new Error(L2.errorMsg.setOnly)},L2.P.use.sig={arg:[3],rtn:!0,min:1,dim:1},L2.P.ind=function(r,e){var t,n,i,o,s,h;if(2===arguments.length){if(n=e.v.length,i=new Array(n),"r"===r)for(t=0;t<n;t++)i[t]=this._getIndLin(+e.v[t])%this.r;else if("c"===r)for(t=0;t<n;t++)i[t]=Math.floor(this._getIndLin(+e.v[t])/this.r)%this.c;else for(h=this.r*this.c,t=0;t<n;t++)i[t]=Math.floor(this._getIndLin(+e.v[t])/h);return new L2.ArJSA(i)}for(s=this[r+"k"],o=new L2.Ar(this[r],(void 0),(!0)),t=0;t<this[r];t++)o.v[t]=t;if(s){o.z=!0,o.rk={};for(t in s)o.rk[t]=s[t]}return o},L2.P.ind.sig={arg:[2],rtn:!0,min:0,dim:1},L2.P.sample=function(r,e){var t,n,e=+e;if(Math.round(e)!==e||e<1||e>L2.ops.maxEnt)throw new Error("invalid sample size");if(0===this.v.length)throw new Error("cannot sample from empty table");if(this[r+"k"])throw new Error("dimension has keys - risk of duplicate key in sample");for(n=new L2.Ar(e,(void 0),(!0)),t=0;t<e;t++)n.v[t]=Math.floor(Math.random()*this[r]);return this._oneDimAr(r,n)},L2.P.sample.sig={arg:[1],rtn:!0,min:1,dim:1},L2.P.cat=function(r,e){if(1!==this.c||1!==this.p)throw new Error("vector expected");if(0===this.r)throw new Error("probability table cannot be empty");var r=+r;if(Math.round(r)!==r||r<1||r>L2.ops.maxEnt)throw new Error("invalid sample size");var t,n,i,o,s=new Array(this.r),h=0;for(t=0;t<this.r;t++){if(i=+this.v[t],i<0||!isFinite(i))throw new Error("probabilities must be non-negative and finite");s[t]=h+=i}if(0===h)throw new Error("one or more probabilities must be non-zero");for(t=0;t<this.r;t++)s[t]/=h;var f=new L2.Ar(r,(void 0),(!0));for(t=0;t<r;t++)for(i=Math.random(),n=0;n<this.r;n++)if(i<=s[n]){f.v[t]=n;break}if(2===arguments.length){if("key"!==e)throw new Error("argument must be 'key'");if(!this.rk)throw new Error("probability table does not have row keys");o=new Array(this.r);for(t in this.rk)o[this.rk[t]]=t;for(t=0;t<r;t++)f.v[t]=o[f.v[t]]}return f},L2.P.cat.sig={arg:[1,1],rtn:!0,min:1,dim:0},L2.P.sum=function(r){var e,t,n,i,o,s,h,f,a,v=0;if("e"===r){for(o=this.v.length,f=v,t=0;t<o;t++)f+=this.v[t];return new L2.ArJSA([f])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,a=e.r*e.c,"r"===r)for(t=n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(f=v,n+=e.r;t<n;t++)f+=this.v[t];e.v[o++]=f}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*a,h=s+a,t=0;t<e.r;t++){for(f=v,n=s+t;n<h;n+=e.r)f+=this.v[n];e.v[o++]=f}else for(e.v=new Array(a),n=this.v.length,t=0;t<a;t++){for(f=v,i=t;i<n;i+=a)f+=this.v[i];e.v[t]=f}return e[r]=1,e},L2.P.sum.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.join=function(r,e){e=void 0===e?",":""+e;var t,n,i,o,s,h,f,a,v,c="";if("e"===r){if(s=this.v.length,a=c,s>0)if(e){for(n=0;n<s-1;n++)a+=this.v[n]+e;a+=this.v[n]}else for(n=0;n<s;n++)a+=this.v[n];return new L2.ArJSA([a])}if(t=new L2.ArShell(this,r)._remRedExtras(r),s=0,v=t.r*t.c,"r"===r)if(i=0,o=t.c*t.p,t.v=new Array(o),t.r)for(;s<o;){if(e){for(a=c,n=0;n<t.r-1;n++)a+=this.v[i++]+e;a+=this.v[i++]}else for(a=c,n=0;n<t.r;n++)a+=this.v[i++];t.v[s++]=a}else for(n=0;n<o;n++)t.v[n]="";else if("c"===r)if(t.v=new Array(t.r*t.p),t.c)for(o=0;o<t.p;o++)for(h=o*v,f=h+v,n=0;n<t.r;n++){if(e){for(a=c,i=h+n;i<f-t.r;i+=t.r)a+=this.v[i]+e;a+=this.v[i]}else for(a=c,i=h+n;i<f;i+=t.r)a+=this.v[i];t.v[s++]=a}else for(i=t.r*t.p,n=0;n<i;n++)t.v[n]="";else if(t.v=new Array(v),i=this.v.length,t.p)for(n=0;n<v;n++){if(e){for(a=c,o=n;o<i-v;o+=v)a+=this.v[o]+e;a+=this.v[o]}else for(a=c,o=n;o<i;o+=v)a+=this.v[o];t.v[s++]=a}else for(n=0;n<v;n++)t.v[n]="";return t[r]=1,t},L2.P.join.sig={arg:[1],rtn:!0,min:0,dim:2},L2.P.prod=function(r){var e,t,n,i,o,s,h,f,a,v=1;if("e"===r){for(o=this.v.length,f=v,t=0;t<o;t++)f*=this.v[t];return new L2.ArJSA([f])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,a=e.r*e.c,"r"===r)for(t=n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(f=v,n+=e.r;t<n;t++)f*=this.v[t];e.v[o++]=f}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*a,h=s+a,t=0;t<e.r;t++){for(f=v,n=s+t;n<h;n+=e.r)f*=this.v[n];e.v[o++]=f}else for(e.v=new Array(a),n=this.v.length,t=0;t<a;t++){for(f=v,i=t;i<n;i+=a)f*=this.v[i];e.v[t]=f}return e[r]=1,e},L2.P.prod.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.min=function(r,e){if(2===arguments.length&&"index"!==e&&"key"!==e)throw new Error("argument must be 'index' or 'key'");var t,n,i,o,s,h,f,a,v,c,u,l,w=1/0;if("e"===r){if("key"===e)throw new Error(L2.errorMsg.noKeyWithE);if(s=this.v.length,u=w,e){for(v=0,n=0;n<s;n++)this.v[n]<u&&(u=this.v[n],v=n);return new L2.ArJSA([v])}for(n=0;n<s;n++)u=Math.min(u,this.v[n]);return new L2.ArJSA([u])}if(t=new L2.ArShell(this,r),"key"===e){if(!this[r+"k"])throw new Error("table has no "+L2.aux.expandDim[r]+" keys");a=this.key(r).v}if(t._remRedExtras(r),s=0,l=t.r*t.c,"r"===r)if(n=i=0,o=t.c*t.p,t.v=new Array(o),e)for(;s<o;)if(t.r){for(u=w,v=0,i+=t.r;n<i;n++)this.v[n]<u&&(u=this.v[n],v=n);t.v[s++]="key"===e?a[v%t.r]:v%t.r}else t.v[s++]="key"===e?"n/a":NaN;else for(;s<o;){for(u=w,i+=t.r;n<i;n++)u=Math.min(u,this.v[n]);t.v[s++]=u}else if("c"===r)if(t.v=new Array(t.r*t.p),e)for(o=0;o<t.p;o++)for(h=o*l,f=h+l,n=0;n<t.r;n++)if(t.c){for(u=w,v=0,c=0,i=h+n;i<f;i+=t.r,c++)this.v[i]<u&&(u=this.v[i],v=c);t.v[s++]="key"===e?a[v]:v}else t.v[s++]="key"===e?"n/a":NaN;else for(o=0;o<t.p;o++)for(h=o*l,f=h+l,n=0;n<t.r;n++){for(u=w,i=h+n;i<f;i+=t.r)u=Math.min(u,this.v[i]);t.v[s++]=u}else if(t.v=new Array(l),i=this.v.length,e)for(n=0;n<l;n++)if(t.p){for(u=w,v=0,c=0,o=n;o<i;o+=l,c++)this.v[o]<u&&(u=this.v[o],v=c);t.v[n]="key"===e?a[v]:v}else t.v[n]="key"===e?"n/a":NaN;else for(n=0;n<l;n++){for(u=w,o=n;o<i;o+=l)u=Math.min(u,this.v[o]);t.v[n]=u}return t[r]=1,t},L2.P.min.sig={arg:[1],rtn:!0,min:0,dim:2},L2.P.max=function(r,e){if(2===arguments.length&&"index"!==e&&"key"!==e)throw new Error("argument must be 'index' or 'key'");var t,n,i,o,s,h,f,a,v,c,u,l,w=-(1/0);if("e"===r){if("key"===e)throw new Error(L2.errorMsg.noKeyWithE);if(s=this.v.length,u=w,e){for(v=0,n=0;n<s;n++)this.v[n]>u&&(u=this.v[n],v=n);return new L2.ArJSA([v])}for(n=0;n<s;n++)u=Math.max(u,this.v[n]);return new L2.ArJSA([u])}if(t=new L2.ArShell(this,r),"key"===e){if(!this[r+"k"])throw new Error("table has no "+L2.aux.expandDim[r]+" keys");a=this.key(r).v}if(t._remRedExtras(r),s=0,l=t.r*t.c,"r"===r)if(n=i=0,o=t.c*t.p,t.v=new Array(o),e)for(;s<o;)if(t.r){for(u=w,v=0,i+=t.r;n<i;n++)this.v[n]>u&&(u=this.v[n],v=n);t.v[s++]="key"===e?a[v%t.r]:v%t.r}else t.v[s++]="key"===e?"n/a":NaN;else for(;s<o;){for(u=w,i+=t.r;n<i;n++)u=Math.max(u,this.v[n]);t.v[s++]=u}else if("c"===r)if(t.v=new Array(t.r*t.p),e)for(o=0;o<t.p;o++)for(h=o*l,f=h+l,n=0;n<t.r;n++)if(t.c){for(u=w,v=0,c=0,i=h+n;i<f;i+=t.r,c++)this.v[i]>u&&(u=this.v[i],v=c);t.v[s++]="key"===e?a[v]:v}else t.v[s++]="key"===e?"n/a":NaN;else for(o=0;o<t.p;o++)for(h=o*l,f=h+l,n=0;n<t.r;n++){for(u=w,i=h+n;i<f;i+=t.r)u=Math.max(u,this.v[i]);t.v[s++]=u}else if(t.v=new Array(l),i=this.v.length,e)for(n=0;n<l;n++)if(t.p){for(u=w,v=0,c=0,o=n;o<i;o+=l,c++)this.v[o]>u&&(u=this.v[o],v=c);t.v[n]="key"===e?a[v]:v}else t.v[n]="key"===e?"n/a":NaN;else for(n=0;n<l;n++){for(u=w,o=n;o<i;o+=l)u=Math.max(u,this.v[o]);t.v[n]=u}return t[r]=1,t},L2.P.max.sig={arg:[1],rtn:!0,min:0,dim:2},L2.P.mean=function(r){var e,t,n,i,o,s,h,f,a,v=0;if("e"===r){for(o=this.v.length,f=v,t=0;t<o;t++)f+=this.v[t];return new L2.ArJSA([f/o])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,a=e.r*e.c,"r"===r)for(t=n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(f=v,n+=e.r;t<n;t++)f+=this.v[t];e.v[o++]=f/e.r}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*a,h=s+a,t=0;t<e.r;t++){for(f=v,n=s+t;n<h;n+=e.r)f+=this.v[n];e.v[o++]=f/e.c}else for(e.v=new Array(a),n=this.v.length,t=0;t<a;t++){for(f=v,i=t;i<n;i+=a)f+=this.v[i];e.v[t]=f/e.p}return e[r]=1,e},L2.P.mean.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.range=function(r){for(var e=this.max(r),t=this.min(r),n=0,i=e.v.length;n<i;n++)e.v[n]-=t.v[n];return e},L2.P.range.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.geoMean=function(r){var e,t,n,i,o,s,h,f,a,v=1;if("e"===r){for(o=this.v.length,f=v,t=0;t<o;t++)f*=this.v[t];return new L2.ArJSA([Math.pow(f,1/o)])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,a=e.r*e.c,"r"===r)for(t=n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(f=v,n+=e.r;t<n;t++)f*=this.v[t];e.v[o++]=Math.pow(f,1/e.r)}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*a,h=s+a,t=0;t<e.r;t++){for(f=v,n=s+t;n<h;n+=e.r)f*=this.v[n];e.v[o++]=Math.pow(f,1/e.c)}else for(e.v=new Array(a),n=this.v.length,t=0;t<a;t++){for(f=v,i=t;i<n;i+=a)f*=this.v[i];e.v[t]=Math.pow(f,1/e.p)}return e[r]=1,e},L2.P.geoMean.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.truthy=function(r){var e,t,n,i,o,s,h,f,a,v=0;if("e"===r){for(o=this.v.length,f=v,t=0;t<o;t++)this.v[t]&&f++;return new L2.ArJSA([f])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,a=e.r*e.c,"r"===r)for(t=n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(f=v,n+=e.r;t<n;t++)this.v[t]&&f++;e.v[o++]=f}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*a,h=s+a,t=0;t<e.r;t++){for(f=v,n=s+t;n<h;n+=e.r)this.v[n]&&f++;e.v[o++]=f}else for(e.v=new Array(a),n=this.v.length,t=0;t<a;t++){for(f=v,i=t;i<n;i+=a)this.v[i]&&f++;e.v[t]=f}return e[r]=1,e},L2.P.truthy.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.any=function(r){var e,t,n,i,o,s,h,f,a,v=!1;if("e"===r){for(o=this.v.length,t=0;t<o;t++)if(this.v[t])return new L2.ArJSA([!0]);return new L2.ArJSA([v])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,a=e.r*e.c,"r"===r)for(n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(f=v,t=n,n+=e.r;t<n;t++)if(this.v[t]){f=!0;break}e.v[o++]=f}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*a,h=s+a,t=0;t<e.r;t++){for(f=v,n=s+t;n<h;n+=e.r)if(this.v[n]){f=!0;break}e.v[o++]=f}else for(e.v=new Array(a),n=this.v.length,t=0;t<a;t++){for(f=v,i=t;i<n;i+=a)if(this.v[i]){f=!0;break}e.v[t]=f}return e[r]=1,e},L2.P.any.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.all=function(r){var e,t,n,i,o,s,h,f,a,v=!0;if("e"===r){for(o=this.v.length,t=0;t<o;t++)if(!this.v[t])return new L2.ArJSA([!1]);return new L2.ArJSA([v])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,a=e.r*e.c,"r"===r)for(n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(f=v,t=n,n+=e.r;t<n;t++)if(!this.v[t]){f=!1;break}e.v[o++]=f}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*a,h=s+a,t=0;t<e.r;t++){for(f=v,n=s+t;n<h;n+=e.r)if(!this.v[n]){f=!1;break}e.v[o++]=f}else for(e.v=new Array(a),n=this.v.length,t=0;t<a;t++){for(f=v,i=t;i<n;i+=a)if(!this.v[i]){f=!1;break}e.v[t]=f}return e[r]=1,e},L2.P.all.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.first=function(r,e){if(2===arguments.length&&"key"!==e)throw new Error("argument must be 'key'");var t,n,i,o,s,h,f,a,v,c,u,l=1/0;if("e"===r){if(e)throw new Error(L2.errorMsg.noKeyWithE);for(s=this.v.length,n=0;n<s;n++)if(this.v[n])return new L2.ArJSA([n]);return new L2.ArJSA([l])}if(t=new L2.ArShell(this,r),e){if(!this[r+"k"])throw new Error("table has no "+L2.aux.expandDim[r]+" keys");v=this.key(r).v}if(t._remRedExtras(r),s=0,u=t.r*t.c,"r"===r)for(o=t.c*t.p,t.v=new Array(o),i=0;s<o;){for(c=l,n=i,i+=t.r;n<i;n++)if(this.v[n]){c=n;break}c===l?t.v[s++]=e?"n/a":l:t.v[s++]=e?v[c%t.r]:c%t.r}else if("c"===r)for(t.v=new Array(t.r*t.p),o=0;o<t.p;o++)for(h=o*u,f=h+u,n=0;n<t.r;n++){for(c=l,a=0,i=h+n;i<f;i+=t.r,a++)if(this.v[i]){c=a;break}c===l?t.v[s++]=e?"n/a":l:t.v[s++]=e?v[c]:c}else for(t.v=new Array(u),i=this.v.length,n=0;n<u;n++){for(c=l,a=0,o=n;o<i;o+=u,a++)if(this.v[o]){c=a;break}c===l?t.v[n]=e?"n/a":l:t.v[n]=e?v[c]:c}return t[r]=1,t},L2.P.first.sig={arg:[1],rtn:!0,min:0,dim:2},L2.P.last=function(r,e){if(2===arguments.length&&"key"!==e)throw new Error("argument must be 'key'");var t,n,i,o,s,h,f,a,v,c,u,l=-(1/0);if("e"===r){if(e)throw new Error(L2.errorMsg.noKeyWithE);for(n=this.v.length-1;n>=0;n--)if(this.v[n])return new L2.ArJSA([n]);return new L2.ArJSA([l])}if(t=new L2.ArShell(this,r),e){if(!this[r+"k"])throw new Error("table has no "+L2.aux.expandDim[r]+" keys");v=this.key(r).v}if(t._remRedExtras(r),u=t.r*t.c,"r"===r)for(o=t.c*t.p,t.v=new Array(o),i=this.v.length-1,s=o-1;s>=0;){for(c=l,n=i,i-=t.r;n>i;n--)if(this.v[n]){c=n;break}c===l?t.v[s--]=e?"n/a":l:t.v[s--]=e?v[c%t.r]:c%t.r}else if("c"===r)for(t.v=new Array(t.r*t.p),s=0,o=0;o<t.p;o++)for(h=o*u,f=(t.c-1)*t.r,n=0;n<t.r;n++){for(c=l,a=t.c-1,i=h+n+f;i>=h;i-=t.r,a--)if(this.v[i]){c=a;break}c===l?t.v[s++]=e?"n/a":l:t.v[s++]=e?v[c]:c}else for(t.v=new Array(u),i=this.v.length,n=0;n<u;n++){for(c=l,a=t.p-1,o=n+(t.p-1)*u;o>=0;o-=u,a--)if(this.v[o]){c=a;break}c===l?t.v[n]=e?"n/a":l:t.v[n]=e?v[c]:c}return t[r]=1,t},L2.P.last.sig={arg:[1],rtn:!0,min:0,dim:2},L2.P.wrap=function(r){var e,t,n,i,o,s,h,f,a,v;if("e"===r){for(o=this.v.length,a=new Array(o),t=0;t<o;t++)a[t]=this.v[t];return new L2.ArJSA([new L2.Box(new L2.ArJSA(a))])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,v=e.r*e.c,"r"===r)for(t=n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(a=new Array(e.r),s=0,n+=e.r;t<n;t++)a[s++]=this.v[t];e.v[o++]=new L2.Box(new L2.ArJSA(a))}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*v,h=s+v,t=0;t<e.r;t++){for(a=new Array(e.c),f=0,n=s+t;n<h;n+=e.r)a[f++]=this.v[n];a=new L2.ArJSA(a),a.r=1,a.c=e.c,e.v[o++]=new L2.Box(a)}else for(e.v=new Array(v),n=this.v.length,t=0;t<v;t++){for(a=new Array(e.p),s=0,i=t;i<n;i+=v)a[s++]=this.v[i];a=new L2.ArJSA(a),a.r=1,a.p=e.p,e.v[t]=new L2.Box(a)}if(e[r]=1,this.e){if(a=this.e[r+"l"])for(t=0,n=e.v.length;t<n;t++)e.v[t]._contents_["label:"](r,a);if(a=this.e[r+"f"])for(t=0,n=e.v.length;t<n;t++)e.v[t]._contents_["fmt:"](r,a);if(a=this.e.ef)for(t=0,n=e.v.length;t<n;t++)e.v[t]._contents_["fmt:"]("e",a)}if(this[r+"k"])for(a=this.key(r),t=0,n=e.v.length;t<n;t++)e.v[t]._contents_["key:"](r,void 0,a);return e},L2.P.wrap.sig={arg:[],rtn:!0,min:0,dim:2},L2.P["var"]=function(r,e){function t(r){var t,n,i,o,s=0,h=0,f=r.length;if(f<2)return NaN;for(t=0;t<f;)n=r[t],i=n-s,s+=i/++t,o=n-s,h+=i*o;return h/(e?f:f-1)}if(2===arguments.length&&"n"!==e)throw new Error("argument must be 'n'");var n,i,o,s;if("e"===r)return new L2.ArJSA([t(this.v)]);if(n=new L2.ArShell(this,r)._remRedExtras(r),"r"===r)if(1===this.c&&1===this.p)n.v=[t(this.v)];else for(n.v=new Array(this.c*this.p),s=0,o=0;o<this.p;o++)for(i=0;i<this.c;i++)n.v[s++]=t(this._twoDim("c","p",new L2.ArJSA([i]),new L2.ArJSA([o])).v);else if("c"===r)for(n.v=new Array(this.r*this.p),s=0,o=0;o<this.p;o++)for(i=0;i<this.r;i++)n.v[s++]=t(this._twoDim("r","p",new L2.ArJSA([i]),new L2.ArJSA([o])).v);else for(n.v=new Array(this.r*this.c),s=0,o=0;o<this.c;o++)for(i=0;i<this.r;i++)n.v[s++]=t(this._twoDim("r","c",new L2.ArJSA([i]),new L2.ArJSA([o])).v);return n[r]=1,n},L2.P["var"].sig={arg:[1],rtn:!0,min:0,dim:2},L2.P.sd=function(r,e){for(var t=2===arguments.length?this["var"](r,e):this["var"](r),n=0,i=t.v.length;n<i;n++)t.v[n]=Math.sqrt(t.v[n]);return t},L2.P.sd.sig={arg:[1],rtn:!0,min:0,dim:2},L2.P.homog=function(r){var e,t,n,i,o,s,h,f,a;if("e"===r){for(o=this.v.length,f=L2.aux.typeL2(this.v[0]),t=1;t<o;t++)if(L2.aux.typeL2(this.v[t])!==f)return new L2.ArJSA([!1]);return new L2.ArJSA([f])}if(e=new L2.ArShell(this,r)._remRedExtras(r),o=0,a=e.r*e.c,"r"===r)for(n=0,i=e.c*e.p,e.v=new Array(i);o<i;){for(t=n,f=L2.aux.typeL2(this.v[t++]),n+=e.r;t<n;t++)if(L2.aux.typeL2(this.v[t])!==f){f=!1;break}e.v[o++]=f}else if("c"===r)for(e.v=new Array(e.r*e.p),i=0;i<e.p;i++)for(s=i*a,h=s+a,t=0;t<e.r;t++){for(n=s+t,f=L2.aux.typeL2(this.v[n]),n+=e.r;n<h;n+=e.r)if(L2.aux.typeL2(this.v[n])!==f){f=!1;break}e.v[o++]=f}else for(e.v=new Array(a),n=this.v.length,t=0;t<a;t++){for(i=t,f=L2.aux.typeL2(this.v[i]),i+=a;i<n;i+=a)if(L2.aux.typeL2(this.v[i])!==f){f=!1;break}e.v[t]=f}return e[r]=1,e},L2.P.homog.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.unwrap=function(r){var e,t,n,i,o,s,h,f,a,v=this.v.length,c=["r","c","p"].filter(function(e){return e!==r});if(1!==this[r])throw new Error("can only unwrap singleton dimension");if(0===v)throw new Error("cannot unwrap empty table");for(h=this.v[0]._contents_,e=0;e<v;e++){if(!(this.v[e]instanceof L2.Box))throw new Error("box expected");if(f=this.v[e]._contents_,f[r]!==h[r]||1!==f[c[0]]||1!==f[c[1]])throw new Error(L2.errorMsg.shapeMismatch)}if(a=h.v.length,L2.assert.maxEnt(v*a),o=new Array(v*a),"r"===r)for(e=0,n=0;n<v;n++)for(f=this.v[n]._contents_.v,t=0;t<a;t++)o[e++]=f[t];else if("c"===r)for(n=0;n<v;n++)for(f=this.v[n]._contents_.v,i=Math.floor(n/this.r)*this.r*a+n%this.r,t=0;t<a;t++)o[i+t*this.r]=f[t];else for(n=0;n<v;n++)for(f=this.v[n]._contents_.v,i=this.r*this.c,t=0;t<a;t++)o[n+t*i]=f[t];return s=new L2.ArShell(this,r),s.v=o,s[r]=a,h[r+"k"]&&s["key:"](r,void 0,h.key(r)),s.e&&(delete s.e[r+"l"],delete s.e[r+"f"],delete s.e.ef,delete s.e.t,delete s.e.i,L2.aux.isEmpty(s.e)&&delete s.e),h.e&&(h.e[r+"l"]&&s["label:"](r,h.e[r+"l"]),h.e[r+"f"]&&s["fmt:"](r,h.e[r+"f"]),h.e.ef&&s["fmt:"]("e",h.e.ef)),s},L2.P.unwrap.sig={arg:[],rtn:!0,min:0,dim:1},L2.P.cuSum=function(r){var e,t,n,i,o,s,h,f;if(o=this.v.length,s=new Array(o),"e"===r){if(0===o)return new L2.ArJSA([]);for(s[0]=this.v[0],t=1;t<o;t++)s[t]=s[t-1]+this.v[t];return new L2.ArJSA(s)}if(e=new L2.ArShell(this),0===o)return e.v=[],e;if(f=e.r*e.c,e.e&&(delete e.e.ef,delete e.e.t,delete e.e.i,L2.aux.isEmpty(e.e)&&delete e.e),"r"===r)for(n=0;n<o;)for(s[n]=this.v[n],n++,t=1;t<e.r;t++,n++)s[n]=s[n-1]+this.v[n];else if("c"===r)for(i=0;i<e.p;i++)for(t=0;t<e.r;t++)for(h=t+f*i,s[h]=this.v[h],n=1;n<e.c;n++)h=t+n*e.r+f*i,s[h]=s[h-e.r]+this.v[h];else for(n=0;n<f;n++)for(s[n]=this.v[n],t=n+f;t<o;t+=f)s[t]=s[t-f]+this.v[t];return e.v=s,e},L2.P.cuSum.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.cuProd=function(r){var e,t,n,i,o,s,h,f;if(o=this.v.length,s=new Array(o),"e"===r){if(0===o)return new L2.ArJSA([]);for(s[0]=this.v[0],t=1;t<o;t++)s[t]=s[t-1]*this.v[t];return new L2.ArJSA(s)}if(e=new L2.ArShell(this),0===o)return e.v=[],e;if(f=e.r*e.c,e.e&&(delete e.e.ef,delete e.e.t,delete e.e.i,L2.aux.isEmpty(e.e)&&delete e.e),"r"===r)for(n=0;n<o;)for(s[n]=this.v[n],n++,t=1;t<e.r;t++,n++)s[n]=s[n-1]*this.v[n];else if("c"===r)for(i=0;i<e.p;i++)for(t=0;t<e.r;t++)for(h=t+f*i,s[h]=this.v[h],n=1;n<e.c;n++)h=t+n*e.r+f*i,s[h]=s[h-e.r]*this.v[h];else for(n=0;n<f;n++)for(s[n]=this.v[n],t=n+f;t<o;t+=f)s[t]=s[t-f]*this.v[t];return e.v=s,e},L2.P.cuProd.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.cuMin=function(r){var e,t,n,i,o,s,h,f;if(o=this.v.length,s=new Array(o),"e"===r){if(0===o)return new L2.ArJSA([]);for(s[0]=this.v[0],t=1;t<o;t++)s[t]=Math.min(s[t-1],this.v[t]);return new L2.ArJSA(s)}if(e=new L2.ArShell(this),0===o)return e.v=[],e;if(f=e.r*e.c,e.e&&(delete e.e.ef,delete e.e.t,delete e.e.i,L2.aux.isEmpty(e.e)&&delete e.e),"r"===r)for(n=0;n<o;)for(s[n]=this.v[n],n++,t=1;t<e.r;t++,n++)s[n]=Math.min(s[n-1],this.v[n]);else if("c"===r)for(i=0;i<e.p;i++)for(t=0;t<e.r;t++)for(h=t+f*i,s[h]=this.v[h],n=1;n<e.c;n++)h=t+n*e.r+f*i,s[h]=Math.min(s[h-e.r],this.v[h]);else for(n=0;n<f;n++)for(s[n]=this.v[n],t=n+f;t<o;t+=f)s[t]=Math.min(s[t-f],this.v[t]);return e.v=s,e},L2.P.cuMin.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.cuMax=function(r){var e,t,n,i,o,s,h,f;if(o=this.v.length,s=new Array(o),"e"===r){if(0===o)return new L2.ArJSA([]);for(s[0]=this.v[0],t=1;t<o;t++)s[t]=Math.max(s[t-1],this.v[t]);return new L2.ArJSA(s)}if(e=new L2.ArShell(this),0===o)return e.v=[],e;if(f=e.r*e.c,e.e&&(delete e.e.ef,delete e.e.t,delete e.e.i,L2.aux.isEmpty(e.e)&&delete e.e),"r"===r)for(n=0;n<o;)for(s[n]=this.v[n],n++,t=1;t<e.r;t++,n++)s[n]=Math.max(s[n-1],this.v[n]);else if("c"===r)for(i=0;i<e.p;i++)for(t=0;t<e.r;t++)for(h=t+f*i,s[h]=this.v[h],n=1;n<e.c;n++)h=t+n*e.r+f*i,s[h]=Math.max(s[h-e.r],this.v[h]);else for(n=0;n<f;n++)for(s[n]=this.v[n],t=n+f;t<o;t+=f)s[t]=Math.max(s[t-f],this.v[t]);return e.v=s,e},L2.P.cuMax.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.cuTruthy=function(r){var e,t,n,i,o,s,h,f;if(o=this.v.length,s=new Array(o),"e"===r){if(0===o)return new L2.ArJSA([]);for(s[0]=this.v[0]?1:0,t=1;t<o;t++)s[t]=s[t-1]+!!this.v[t];return new L2.ArJSA(s)}if(e=new L2.ArShell(this),0===o)return e.v=[],e;if(f=e.r*e.c,e.e&&(delete e.e.ef,delete e.e.t,delete e.e.i,L2.aux.isEmpty(e.e)&&delete e.e),"r"===r)for(n=0;n<o;)for(s[n]=this.v[n]?1:0,n++,t=1;t<e.r;t++,n++)s[n]=s[n-1]+!!this.v[n];else if("c"===r)for(i=0;i<e.p;i++)for(t=0;t<e.r;t++)for(h=t+f*i,s[h]=this.v[h]?1:0,n=1;n<e.c;n++)h=t+n*e.r+f*i,s[h]=s[h-e.r]+!!this.v[h];else for(n=0;n<f;n++)for(s[n]=this.v[n]?1:0,t=n+f;t<o;t+=f)s[t]=s[t-f]+!!this.v[t];return e.v=s,e},L2.P.cuTruthy.sig={arg:[],rtn:!0,min:0,dim:2},L2.P.serial=function(){function r(e){var t,n,i;if(e.e&&(e.e.rf||e.e.cf||e.e.pf||e.e.ef))throw new Error("table must not have format functions");for(t=0,n=e.v.length;t<n;t++)if(i=typeof e.v[t],"number"!==i&&"boolean"!==i&&"string"!==i&&"undefined"!==i){if(!(e.v[t]instanceof L2.Box))throw new Error("entry cannot be of type date, regex or function");r(e.v[t]._contents_)}}return r(this),JSON.stringify(this)},L2.P.serial.sig={arg:[],rtn:!1,min:0,dim:0},L2.P.save=function(r){
if(".L2T"!==r.slice(-4).toUpperCase())throw new Error("file extension must be '.L2T'");return L2.sc.write(this.serial(),r),!0},L2.P.save.sig={arg:[1],rtn:!1,min:1,dim:0},L2.P.saveCSV=function(r,e){var t,n,i,o,s,h,f,a,s="";if(0===this.v.length)throw new Error("cannot save empty table as csv file");if(2===arguments.length){if("name"!==e)throw new Error("argument must be 'name'");if(!this.ck)throw new Error("cannot use 'name' if table does not have column keys");for(i=this.key("c").v,h=0;h<this.c-1;h++)s+=L2.aux.exportStringCSV(i[h])+",";s+=L2.aux.exportStringCSV(i[this.c-1])+"\n"}for(t=this.r*this.c,a=0;a<this.p;a++)for(h=0;h<this.r;h++)for(f=0;f<this.c;f++)n=this.v[h+f*this.r+a*t],o=typeof n,"number"===o||"boolean"===o?s+=n:"string"===o?s+=L2.aux.exportStringCSV(n):void 0!==n&&(s+=L2.aux.exportStringCSV(n.toString())),s+=f===this.c-1?"\n":",";return L2.sc.write(s,r),!0},L2.P.saveCSV.sig={arg:[1,1],rtn:!1,min:1,dim:0},L2.P.toJSONa=function(){return JSON.stringify(L2.toJS(this))},L2.P.toJSONa.sig={arg:[],rtn:!1,min:0,dim:0},L2.P.unique=function(){var r,e,t,n={},i=this.v.length,o=new Array(i);for(e=0,r=0;r<i;r++)t=this.v[r],n[t]||(n[t]=1,o[e++]=t);return new L2.ArJSA(o.slice(0,e))},L2.P.unique.sig={arg:[],rtn:!0,min:0,dim:0},L2.P.isUnique=function(){return L2.aux.uniqueJSA_strEq(this.v)},L2.P.isUnique.sig={arg:[],rtn:!1,min:0,dim:0},L2.P.inter=function(r){var e,t,n,i=this.v.length,o=r.v.length,s={},h={},f=new Array(Math.min(i,o));for(e=0;e<o;e++)s[r.v[e]]=1;for(t=0,e=0;e<i;e++)n=this.v[e],s[n]&&!h[n]&&(f[t++]=n,h[n]=1);return new L2.ArJSA(f.slice(0,t))},L2.P.inter.sig={arg:[2],rtn:!0,min:1,dim:0},L2.P.union=function(r){var e,t,n,i={},o=this.v.length,s=r.v.length,h=new Array(o+s);for(t=0,e=0;e<o;e++)n=this.v[e],i[n]||(i[n]=1,h[t++]=n);for(e=0;e<s;e++)n=r.v[e],i[n]||(i[n]=1,h[t++]=n);return L2.assert.maxEnt(t),new L2.ArJSA(h.slice(0,t))},L2.P.union.sig={arg:[2],rtn:!0,min:1,dim:0},L2.P.diff=function(r){var e,t,n,i=this.v.length,o=r.v.length,s={},h={},f=new Array(i);for(e=0;e<o;e++)s[r.v[e]]=1;for(t=0,e=0;e<i;e++)n=this.v[e],s[n]||h[n]||(f[t++]=n,h[n]=1);return new L2.ArJSA(f.slice(0,t))},L2.P.diff.sig={arg:[2],rtn:!0,min:1,dim:0},L2.P.symmDiff=function(r){var e=this.diff(r).v.concat(r.diff(this).v);return L2.assert.maxEnt(e.length),new L2.ArJSA(e)},L2.P.symmDiff.sig={arg:[2],rtn:!0,min:1,dim:0},L2.P["in"]=function(r){var e,t={},n=this.v.length,i=r.v.length,o=new Array(n);for(e=0;e<i;e++)t[r.v[e]]=!0;for(e=0;e<n;e++)o[e]=!!t[this.v[e]];return new L2.ArJSA(o)},L2.P["in"].sig={arg:[2],rtn:!0,min:1,dim:0},L2.P.freq=function(r){if(1===arguments.length&&"key"!==r)throw new Error("argument must be 'key'");var e,t,n,i,o,s,h=this.v.length,f={},a=0;for(e=0;e<h;e++)n=this.v[e],f[n]?f[n]++:(f[n]=1,a++);if(t=0,r){o=new Array(a),i=new Array(a);for(e in f)o[t]=e,i[t++]=f[e];return new L2.ArJSA(i)["key:"]("r",void 0,new L2.ArJSA(o))}L2.assert.maxEnt(2*a),o=new Array(2*a);for(e in f)o[t]=e,o[t+a]=f[e],t++;return s=new L2.ArJSA(o),s.r=a,s.c=2,s["key:"]("c",void 0,new L2.ArJSA(["value","frequency"])),s},L2.P.freq.sig={arg:[1],rtn:!0,min:0,dim:0},L2.P.hasKey=function(r){return!!this[r+"k"]},L2.P.hasKey.sig={arg:[],rtn:!1,min:0,dim:1},L2.P.sort=function(r,e){var t,n,i,o,s,h=this.v.length,f=new Array(h);if(void 0===r)r="asc";else if(o="function"==typeof r,"desc"!==r&&"asc"!==r&&!o)throw new Error("'asc', 'desc' or function expected");if(arguments.length>1&&"index"!==e)throw new Error("argument must be 'index'");if(0===h)return new L2.ArJSA([]);if(o||L2.assert.homogType(this),i=typeof this.v[0],e){for(n=this.v,t=0;t<h;t++)f[t]=t;if("asc"===r)"string"===i?f.sort(function(r,e){var r=n[r],e=n[e];return r>e?1:r<e?-1:0}):f.sort(function(r,e){return n[r]-n[e]});else if("desc"===r)"string"===i?f.sort(function(r,e){var r=n[r],e=n[e];return r<e?1:r>e?-1:0}):f.sort(function(r,e){return n[e]-n[r]});else{for(s=new Array(h),t=0;t<h;t++)s[t]=L2.tabIfBox(this.v[t]);f.sort(function(e,t){return L2.sca(r(s[e],s[t]))})}}else if("asc"===r){for(t=0;t<h;t++)f[t]=this.v[t];"string"===i?f.sort():f.sort(function(r,e){return r-e})}else if("desc"===r){for(t=0;t<h;t++)f[t]=this.v[t];"string"===i?f.sort().reverse():f.sort(function(r,e){return e-r})}else{for(s=new Array(h),t=0;t<h;t++)f[t]=t,s[t]=L2.tabIfBox(this.v[t]);for(f.sort(function(e,t){return L2.sca(r(s[e],s[t]))}),t=0;t<h;t++)f[t]=this.v[f[t]]}return new L2.ArJSA(f)},L2.P.sort.sig={arg:[1,1],rtn:!0,min:0,dim:0},L2.P.asc=function(r){return 1===arguments.length?this.sort("asc",r):this.sort("asc")},L2.P.asc.sig={arg:[1],rtn:!0,min:0,dim:0},L2.P.desc=function(r){return 1===arguments.length?this.sort("desc",r):this.sort("desc")},L2.P.desc.sig={arg:[1],rtn:!0,min:0,dim:0},L2.P.map=function(r){var e,t,n,i=this.v.length;if("function"!=typeof r)throw new Error("function expected");for(t=new L2.ArShell(this),t.v=new Array(i),e=0;e<i;e++)n=this.v[e],n=r(n instanceof L2.Box?n._contents_:n,e,this),t.v[e]=n instanceof L2.Ar?new L2.Box(n):n;return t},L2.P.map.sig={arg:[1],rtn:!0,min:1,dim:0},L2.P._filterFind=function(r,e){var t=this.v.length,n=new Array(t),i=0,o=0;if(r)if(e)for(;i<t;i++)L2.sca(r(L2.tabIfBox(this.v[i]),i,this))&&(n[o++]=i);else for(;i<t;i++)L2.sca(r(L2.tabIfBox(this.v[i]),i,this))&&(n[o++]=this.v[i]);else if(e)for(;i<t;i++)this.v[i]&&(n[o++]=i);else for(;i<t;i++)this.v[i]&&(n[o++]=this.v[i]);return n.length=o,new L2.ArJSA(n)},L2.P.find=function(r){if(1===arguments.length&&"function"!=typeof r)throw new Error("function expected");return this._filterFind(r,!0)},L2.P.find.sig={arg:[1],rtn:!0,min:0,dim:0},L2.P.filter=function(r){if(1===arguments.length&&"function"!=typeof r)throw new Error("function expected");return this._filterFind(r)},L2.P.filter.sig={arg:[1],rtn:!0,min:0,dim:0},L2.P.nest=function(){function r(r,e){var t,n,i,o;if(i=new Array(r[e]),o=r[e+"k"])for(t in o)i[o[t]]=t;else if("c"===e)for(t=0,n=r[e];t<n;t++)i[t]="col_"+t;else for(t=0,n=r[e];t<n;t++)i[t]=t;return i}var e,t,n,i,o,s,h,f,a,v,c;f=r(this,"r"),h=r(this,"c"),h.push(this.e&&"rl"in this.e?this.e.rl:"row"),(this.e&&(s="pl"in this.e)||this.p>1||this.pk)&&(h.push(s?this.e.pl:"page"),a=r(this,"p")),c=new L2.ArJSA(new Array(h.length))["key:"]("r",void 0,new L2.ArJSA(h)),o=new Array(this.r*this.p),i=this.r*this.c;for(n=0;n<this.p;n++)for(e=0;e<this.r;e++){for(v=new L2.ArCopy(c,(!0)),t=0;t<this.c;t++)v.v[t]=this.v[i*n+this.r*t+e];v.v[this.c]=f[e],a&&(v.v[this.c+1]=a[n]),o[this.r*n+e]=new L2.Box(v)}return new L2.ArJSA(o)},L2.P.nest.sig={arg:[],rtn:!0,min:0,dim:0},L2.P._where=function(r,e,t){L2.assert.dataMatrix(this);var n,i,o,s=new Array(this.r),h=this._getInd(r,"c")*this.r,f=0;if(e instanceof L2.Ar){if(i=e.v.length,1!==i){for(o={},n=0;n<i;n++)o[e.v[n]]=1;if(t)for(n=0;n<this.r;n++)o[this.v[h+n]]||(s[f++]=n);else for(n=0;n<this.r;n++)o[this.v[h+n]]&&(s[f++]=n);return this._oneDimAr("r",new L2.ArJSA(s.slice(0,f)))}e=e.v[0]}if("function"==typeof e)if(t)for(n=0;n<this.r;n++)L2.sca(e(L2.tabIfBox(this.v[h+n]),n,this))||(s[f++]=n);else for(n=0;n<this.r;n++)L2.sca(e(L2.tabIfBox(this.v[h+n]),n,this))&&(s[f++]=n);else if(o={},o[e]=1,t)for(n=0;n<this.r;n++)o[this.v[h+n]]||(s[f++]=n);else for(n=0;n<this.r;n++)o[this.v[h+n]]&&(s[f++]=n);return this._oneDimAr("r",new L2.ArJSA(s.slice(0,f)))},L2.P.where=function(r,e){return this._where(r,e)},L2.P.where.sig={arg:[1,3],rtn:!0,min:2,dim:0},L2.P.unless=function(r,e){return this._where(r,e,!0)},L2.P.unless.sig={arg:[1,3],rtn:!0,min:2,dim:0},L2.P["_where:"]=function(r,e,t,n){L2.assert.dataMatrix(this);var i,o,s,h,f,a,v=new Array(this.r),c=this._getInd(r,"c")*this.r,u=0,l=t instanceof L2.Ar;if(l&&(h=t.v.length),e instanceof L2.Ar){if(o=e.v.length,1!==o){for(s={},i=0;i<o;i++)s[e.v[i]]=1;if(n)for(i=0;i<this.r;i++)s[this.v[c+i]]||(v[u++]=i);else for(i=0;i<this.r;i++)s[this.v[c+i]]&&(v[u++]=i);if(l){if(1!==h){if(h!==o)throw new Error(L2.errorMsg.shapeMismatch);for(f={},i=0;i<h;i++)f[e.v[i]]=t.v[i];for(i=0;i<u;i++)this.v[c+v[i]]=f[this.v[c+v[i]]];return this}t=t.v[0]}if("function"==typeof t){for(a=new Array(u),i=0;i<u;i++)a[i]=L2.boxIfTab(t(L2.tabIfBox(this.v[c+v[i]]),v[i],this));for(i=0;i<u;i++)this.v[c+v[i]]=a[i]}else for(i=0;i<u;i++)this.v[c+v[i]]=t;return this}e=e.v[0]}if("function"==typeof e)if(n)for(i=0;i<this.r;i++)L2.sca(e(L2.tabIfBox(this.v[c+i]),i,this))||(v[u++]=i);else for(i=0;i<this.r;i++)L2.sca(e(L2.tabIfBox(this.v[c+i]),i,this))&&(v[u++]=i);else if(s={},s[e]=1,n)for(i=0;i<this.r;i++)s[this.v[c+i]]||(v[u++]=i);else for(i=0;i<this.r;i++)s[this.v[c+i]]&&(v[u++]=i);if(l){if(1!==h)throw new Error(L2.errorMsg.shapeMismatch);t=t.v[0]}if("function"==typeof t){for(a=new Array(u),i=0;i<u;i++)a[i]=L2.boxIfTab(t(L2.tabIfBox(this.v[c+v[i]]),v[i],this));for(i=0;i<u;i++)this.v[c+v[i]]=a[i]}else for(i=0;i<u;i++)this.v[c+v[i]]=t;return this},L2.P["where:"]=function(r,e,t){return this["_where:"](r,e,t)},L2.P["where:"].sig={arg:[1,3,3],rtn:!0,min:3,dim:0},L2.P["unless:"]=function(r,e,t){return this["_where:"](r,e,t,!0)},L2.P["unless:"].sig={arg:[1,3,1],rtn:!0,min:3,dim:0},L2.P.count=function(r){function e(r){for(var e=new Array(r),t=0;t<r;t++)e[t]=0;return e}var t,n,i,o,s,h,f,a,v,c,u;if(L2.assert.dataMatrix(this),0===r.v.length)throw new Error("must specify at least 1 column (pass ~ to use all)");if(L2.ge.isNil(r))for(i=this.c,r=new Array(i),t=0;t<i;t++)r[t]=t;else i=r.v.length,r=L2.aux.colInd(this,r).v;for(s={},t=0;t<i;t++)for(h=this.r*r[t],n=0;n<this.r;n++)o=this.v[h+n],s[o]?s[o][t]++:(s[o]=e(i),s[o][t]=1);for(f=Object.keys(s),a=f.length,L2.assert.maxEnt(a*i),v=new L2.ArFast(a,i,1),t=0;t<i;t++)for(n=0;n<a;n++)v.v[t*a+n]=s[f[n]][t];if(v["key:"]("r",void 0,new L2.ArJSA(f)),this.z){if(this.ck){for(c=L2.aux.keyValFlip(this.ck),u=new Array(i),t=0;t<i;t++)u[t]=c[r[t]];v["key:"]("c",void 0,new L2.ArJSA(u))}this.pk&&v["key:"]("p",void 0,Object.keys(this.pk)[0]),this.e&&(this.e.cl&&v["label:"]("c",this.e.cl),this.e.pl&&v["label:"]("p",this.e.pl),this.e.cf&&v["fmt:"]("c",this.e.cf),this.e.pf&&v["fmt:"]("p",this.e.pf))}return v},L2.P.count.sig={arg:[2],rtn:!0,min:1,dim:0},L2.P.group=function(r,e){function t(r){return r.e&&(r.e.title&&r["title:"](void 0),r.e.info&&r["info:"](void 0)),r}function n(r){var e,t,n,i=2===r?L[0]*L[1]:1===r?L[0]:1;for(t=0;t<L[r];t++)for(e=l[r][w[r][t]],n=0;n<e.length;n++)v[e[n]]+=i*t}var i,o,s,h,f,a,v,c,u,l=[{},{},{}],w=new Array(3),p=new Array(3),L=[0,0,0],g=r.v.length,d=3===g;if(L2.assert.dataMatrix(this),0===g||g>3)throw new Error("must specify 1, 2 or 3 columns to group on");if(2===arguments.length&&"tally"!==e&&"function"!=typeof e)throw new Error("function or 'tally' expected");if(h=L2.aux.colInd(this,r),c=L2.sc.range(0,this.c-1).unless(0,h),function(e){var t,n,i,o,s;for(t=0;t<g;t++){for("number"==typeof r.v[t]?p[t]=e.ck?e._getKey(h.v[t],"c"):h.v[t]:p[t]=r.v[t],o=h.v[t]*e.r,n=0;n<e.r;n++)s=e.v[o+n],l[t][s]?l[t][s].push(n):(l[t][s]=[n],L[t]++);w[t]=new Array(L[t]),i=0;for(n in l[t])w[t][i++]=n}}(this),1===g){if(f=new Array(L[0]),"tally"===e)for(i=0;i<L[0];i++)f[i]=l[0][w[0][i]].length;else for(i=0;i<L[0];i++)s=w[0][i],o=t(this._twoDim("r","c",new L2.ArJSA(l[0][s]),c)),"function"==typeof e?(o=e(o,s),f[i]=o instanceof L2.Ar?new L2.Box(o):o):f[i]=new L2.Box(o);return new L2.ArJSA(f)["key:"]("r",void 0,new L2.ArJSA(w[0]))["label:"]("r",p[0])}for(a=L[0]*L[1]*(d?L[2]:1),L2.assert.maxEnt(a),f=new Array(a),i=0;i<a;i++)f[i]=[];for(v=new Array(this.r),i=0;i<this.r;i++)v[i]=0;for(n(0),n(1),d&&n(2),i=0;i<this.r;i++)f[v[i]].push(i);if("tally"===e)for(i=0;i<a;i++)f[i]=f[i].length;else for(i=0;i<a;i++)o=t(this._twoDim("r","c",new L2.ArJSA(f[i]),c)),"function"==typeof e?(o=d?e(o,w[0][i%L[0]],w[1][Math.floor(i/L[0])%L[1]],w[2][Math.floor(i/(L[0]*L[1]))]):e(o,w[0][i%L[0]],w[1][Math.floor(i/L[0])]),f[i]=o instanceof L2.Ar?new L2.Box(o):o):f[i]=new L2.Box(o);return u=new L2.ArJSA(f),u.r=L[0],u.c=L[1],d&&(u.p=L[2]),u["key:"]("r",void 0,new L2.ArJSA(w[0]))["key:"]("c",void 0,new L2.ArJSA(w[1]))["label:"]("r",p[0])["label:"]("c",p[1]),d&&u["key:"]("p",void 0,new L2.ArJSA(w[2]))["label:"]("p",p[2]),u},L2.P.group.sig={arg:[2,1],rtn:!0,min:1,dim:0},L2.P.merge=function(r,e,t,n){function i(r){for(var e={},t=0;t<r;t++)e[t]=t;return e}function o(r,e){for(var t,n,i={},o=0;o<r.r;o++)n=r.v[r.r*e+o],t=i[n],void 0===t?i[n]=o:"number"==typeof t?i[n]=[t,o]:t.push(o);return i}var s,h,f,a,v,c,u,l,w,p,L,g,d,m,A,y,x,E,_,S="inner",b="",k="",M=this,P=M.c+e.c;if(L2.assert.dataMatrix(M),L2.assert.dataMatrix(e),4===arguments.length){if(!L2.ge.isDict(n))throw new Error("dictionary expected");for(s in n.rk)if(a=n.v[n.rk[s]],"join"===s){if(["inner","outer","left","right","cross"].indexOf(a)===-1)throw new Error("invalid join type");S=a}else if("leftPrefix"===s)b+=a;else{if("rightPrefix"!==s)throw new Error("invalid merge option");k+=a}}if(M.ck&&!e.ck)throw new Error("second table has no column keys");if("cross"===S){for(l=M.r*e.r,L2.assert.maxEnt(l*P),c=new Array(l*P),f=0;f<M.c;f++)for(h=0;h<M.r;h++)for(v=M.v[M.r*f+h],p=f*l+e.r*h,s=0;s<e.r;s++)c[p+s]=v;for(f=0;f<e.c;f++)for(h=0;h<M.r;h++)for(p=(M.c+f)*l+e.r*h,s=0;s<e.r;s++)c[p+s]=e.v[f*e.r+s]}else{if(void 0===r?L=M.rk||i(M.r):(r=M._getInd(r,"c"),L=o(M,r)),void 0===t)if(e.rk){g={};for(s in e.rk)g[s]=e.rk[s]}else g=i(e.r);else t=e._getInd(t,"c"),g=o(e,t);d=[],m=[],y=[],x=[];for(s in L)if(E=L[s],_=g[s],"number"==typeof E)if(void 0===_)y.push(E);else{if("number"==typeof _)d.push(E),m.push(_);else for(h=0;h<_.length;h++)d.push(E),m.push(_[h]);delete g[s]}else if(void 0===_)for(h=0;h<E.length;h++)y.push(E[h]);else{if("number"==typeof _)for(h=0;h<E.length;h++)d.push(E[h]),m.push(_);else for(h=0;h<E.length;h++)for(f=0;f<_.length;f++)d.push(E[h]),m.push(_[f]);delete g[s]}if("right"===S||"outer"===S)for(s in g)if(_=g[s],"number"==typeof _)x.push(_);else for(h=0;h<_.length;h++)x.push(_[h]);switch(A=d.length,l=A,S){case"left":l+=y.length;break;case"right":l+=x.length;break;case"outer":l+=y.length+x.length}for(L2.assert.maxEnt(l*P),c=new Array(l*P),h=0;h<M.c;h++)for(s=0;s<A;s++)c[h*l+s]=M.v[h*M.r+d[s]];for(h=0;h<e.c;h++)for(s=0;s<A;s++)c[(M.c+h)*l+s]=e.v[h*e.r+m[s]];if(p=A,"left"===S||"outer"===S){for(h=0;h<M.c;h++)for(f=h*l+A,s=0;s<y.length;s++)c[f+s]=M.v[h*M.r+y[s]];p+=y.length}if("right"===S||"outer"===S)for(h=0;h<e.c;h++)for(f=(M.c+h)*l+p,s=0;s<x.length;s++)c[f+s]=e.v[h*e.r+x[s]]}if(u=new L2.ArJSA(c),u.r=l,u.c=P,("inner"===S||"left"===S)&&void 0===t){if(M.rk){for(w=new Array(A+y.length),v=M.key("r").v,s=0;s<A;s++)w[s]=v[d[s]];if("left"===S)for(s=0;s<y.length;s++)w[A+s]=v[y[s]];else w.length=A;u["key:"]("r",void 0,new L2.ArJSA(w))}M.e&&(M.e.rl&&u["label:"]("r",M.e.rl),M.e.rf&&u["fmt:"]("r",M.e.rf))}return M.ck&&u["key:"]("c",void 0,new L2.ArJSA(M.key("c").v.map(function(r){return b+r}).concat(e.key("c").v.map(function(r){return k+r})))),M.pk&&u["key:"]("p",void 0,M.key("p")),M.e&&(M.e.pl&&u["label:"]("p",M.e.pl),M.e.pf&&u["fmt:"]("p",M.e.pf)),u},L2.P.merge.sig={arg:[1,2,1,2],rtn:!0,min:3,dim:0},L2.P.inside=function(r,e,t){function n(r,e,t,n){if(r.z){var i=e+"k",o=n+"k";if(r[i]){t[o]={};for(var s in r[i])t[o][s]=r[i][s];t.z=!0}r.e&&(t["label:"](n,r.e[e+"l"]),t["fmt:"](n,r.e[e+"f"]))}}function i(r,e,t){n(r,"r",t,"r"),n(r,"p",t,"p"),e&&n(e,"r",t,"c")}var o,s,h,f,a,v,c,u,l,w={rect:function(r,e,t,n,i,o,s){return r>=t-s&&e>=n-s&&r<=+t+Math.abs(i)+s&&e<=+n+Math.abs(o)+s},circle:function(r,e,t,n,i,o,s){return Math.sqrt(Math.pow(r-t,2)+Math.pow(e-n,2))<=Math.abs(i)/2+s},ellipse:function(r,e,t,n,i,o){return Math.pow((r-t)/(i/2),2)+Math.pow((e-n)/(o/2),2)<=1},segment:function(r,e,t,n,i,o,s){if(w.circle(r,e,t,n,0,void 0,s)||w.circle(r,e,i,o,0,void 0,s))return!0;var h=Math.sqrt(Math.pow(o-n,2)+Math.pow(i-t,2)),f=((r-t)*(i-t)+(e-n)*(o-n))/h;return f>=0&&f<=h&&Math.abs((o-n)*r-(i-t)*e+i*n-o*t)/h<=s},polygon:function(r,e,t){var n,i,o,s,h=t.v,f=!1;for(e=+e,n=0,i=t.r-1;n<t.r;i=n++)o=h[n+t.r],s=h[i+t.r],o>e!=s>e&&r<(h[i]-h[n])*(e-o)/(s-o)+ +h[n]&&(f=!f);return f},polyline:function(r,e,t,n){for(var i=0;i<t.r-1;i++)if(w.segment(r,e,t.v[i],t.v[i+t.r],t.v[i+1],t.v[i+1+t.r],n))return!0;return!1}};if(2!==this.c||1!==this.p)throw new Error("2-column matrix expected");if(l=w[r],!l)throw new Error("invalid shape name");if(arguments.length>2){if("polygon"===r||"ellipse"===r)throw new Error("cannot use a margin with '"+r+"'");t=+t}else t=0;if("polygon"===r||"polyline"===r){if("boxed"!==L2.aux.polyData(e)){for(h=new L2.ArFast(this.r,1,1),o=0;o<this.r;o++)h.v[o]=l(this.v[o],this.v[o+this.r],e,t);return i(this,void 0,h),h}for(L2.assert.maxEnt(this.r*e.r),h=new L2.ArFast(this.r,e.r,1),s=0;s<e.r;s++)for(f=e.v[s]._contents_,o=0;o<this.r;o++)h.v[o+s*this.r]=l(this.v[o],this.v[o+this.r],f,t)}else{if(1!==e.p)throw new Error("matrix expected");if("circle"===r&&3!==e.c||"circle"!==r&&4!==e.c)throw new Error("wrong number of columns for given shape");for(L2.assert.maxEnt(this.r*e.r),h=new L2.ArFast(this.r,e.r,1),s=0;s<e.r;s++)for(a=e.v[s],v=e.v[s+e.r],c=e.v[s+2*e.r],u=e.v[s+3*e.r],o=0;o<this.r;o++)h.v[o+s*this.r]=l(this.v[o],this.v[o+this.r],a,v,c,u,t)}return i(this,e,h),h},L2.P.inside.sig={arg:[1,2,1],rtn:!0,min:2,dim:0},L2.P.mm=function(r){var e,t,n,i,o,s,h,f,a,v=new L2.ArTp(this),c=0===v.p||0===r.p?0:Math.max(v.p,r.p),u=v.c,l=r.c,w=v.r,p=u*l*c;L2.assert.maxEnt(p);var L=new L2.ArFast(u,l,c);if(this._twoMatExtras(r,L),w!==r.r||1!==v.p&&1!==r.p&&v.p!==r.p)throw new Error(L2.errorMsg.shapeMismatch);if(0===w||0===u||0===l||0===c)return L;for(f=1===v.p?0:u*w,a=1===r.p?0:w*l,i=0;i<c;i++)for(t=0;t<l;t++)for(h=t*w+i*a,e=0;e<u;e++){for(s=e*w+i*f,o=0,n=0;n<w;n++)o+=v.v[s+n]*r.v[h+n];L.v[e+t*u+i*u*l]=o}return L},L2.P.mm.sig={arg:[2],rtn:!0,min:1,dim:0},L2.P.outer=function(r,e){L2.assert.func(e);var t,n,i,o,s,h,f,a,v=0===this.p||0===r.p?0:Math.max(this.p,r.p),c=this.r,u=r.r,l=c*u*v;L2.assert.maxEnt(l);var w=new L2.ArFast(c,u,v);if(this._twoMatExtras(r,w,!0),this.c!==r.c||1!==this.p&&1!==r.p&&this.p!==r.p)throw new Error(L2.errorMsg.shapeMismatch);if(0===w.v.length)return w;if(1===v){for(f=new Array(u),n=0;n<u;n++)f[n]=r._oneDimSc("r",n);for(t=0;t<c;t++)for(o=this._oneDimSc("r",t),n=0;n<u;n++)w.v[t+n*c]=L2.sca(e(o,f[n]))}else if(1===this.p){for(h=new Array(c),t=0;t<c;t++)h[t]=this._oneDimSc("r",t);for(i=0;i<v;i++)for(a=new L2.ArJSA([i]),n=0;n<u;n++)for(s=r._twoDim("r","p",new L2.ArJSA([n]),a),t=0;t<c;t++)w.v[t+n*c+i*c*u]=L2.sca(e(h[t],s))}else if(1===r.p){for(f=new Array(u),n=0;n<u;n++)f[n]=r._oneDimSc("r",n);for(i=0;i<v;i++)for(a=new L2.ArJSA([i]),t=0;t<c;t++)for(o=this._twoDim("r","p",new L2.ArJSA([t]),a),n=0;n<u;n++)w.v[t+n*c+i*c*u]=L2.sca(e(o,f[n]))}else for(f=new Array(u),i=0;i<v;i++){for(a=new L2.ArJSA([i]),n=0;n<u;n++)f[n]=r._twoDim("r","p",new L2.ArJSA([n]),a);for(t=0;t<c;t++)for(o=this._twoDim("r","p",new L2.ArJSA([t]),a),n=0;n<u;n++)w.v[t+n*c+i*c*u]=L2.sca(e(o,f[n]))}return w},L2.P.outer.sig={arg:[2,1],rtn:!0,min:2,dim:0},L2.P.inv=function(){var r,e,t;if(this.r!==this.c)throw new Error("matrix must be square");for(e=L2.linAlg.matrix(this),r=0;r<this.p;r++)e[r]=numeric.inv(e[r]);return t=L2.linAlg.unmatrix(e,this.r,this.c,this.p),L2.linAlg.copyPageExtras(this,t),t},L2.P.inv.sig={arg:[],rtn:!0,min:0,dim:0},L2.P.det=function(){var r,e,t,n,i;if(this.r!==this.c)throw new Error("matrix must be square");for(e=L2.linAlg.matrix(this),t=new Array(this.p),r=0;r<this.p;r++){if(i=numeric.det(e[r]),"number"!=typeof i)throw new Error("number expected");t[r]=i}return n=new L2.ArJSA(t),n.r=n.c=1,n.p=this.p,L2.linAlg.copyPageExtras(this,n),n},L2.P.det.sig={arg:[],rtn:!0,min:0,dim:0},L2.P.svd=function(){var r,e,t,n,i,o,s,h,f,a,v,c;if(this.r<this.c)throw new Error("number of rows must be  number of columns");for(n=L2.linAlg.matrix(this),f=this.c,a=this.p,o=new Array(a),s=new Array(f*a),h=new Array(a),t=0,r=0;r<a;r++)for(i=numeric.svd(n[r]),o[r]=i.U,h[r]=i.V,e=0;e<f;e++,t++)s[t]=i.S[e];return c=new L2.ArJSA(new Array(3)),c["key:"]("r",void 0,new L2.ArJSA(["U","S","V"])),v=L2.linAlg.unmatrix(o,this.r,f,a),L2.linAlg.copyPageExtras(this,v),c.v[0]=new L2.Box(v),v=L2.linAlg.unmatrix(h,f,f,a),L2.linAlg.copyPageExtras(this,v),c.v[2]=new L2.Box(v),v=new L2.ArJSA(s),v.r=f,v.p=a,L2.linAlg.copyPageExtras(this,v),c.v[1]=new L2.Box(v),c},L2.P.svd.sig={arg:[],rtn:!0,min:0,dim:0},L2.linAlg={copyPageExtras:function(r,e){if(r.pk){e.z=!0,e.pk={};for(var t in r.pk)e.pk[t]=r.pk[t]}r.e&&(r.e.pl||r.e.pf)&&(e.z=!0,e.e=e.e||{},r.e.pl&&(e.e.pl=r.e.pl),r.e.pf&&(e.e.pf=r.e.pf))},eye:function(r){var e,t,n,i,o;for(r=+r,L2.assert.posInt(r),e=r*r,L2.assert.maxEnt(e),t=new Array(e),o=r+1,n=0;n<e;n++)t[n]=0;for(n=0;n<e;n+=o)t[n]=1;return i=new L2.ArJSA(t),i.r=i.c=r,i},matrix:function(r){var e,t,n,i,o,s,h;if(0===r.v.length)throw new Error("cannot convert empty table to matrix");for(h=r.r*r.c,i=new Array(r.p),n=0;n<r.p;n++)for(i[n]=new Array(r.r),e=0;e<r.r;e++)for(o=i[n][e]=new Array(r.c),t=0;t<r.c;t++){if(s=r.v[n*h+t*r.r+e],"number"!=typeof s)throw new Error("entry must be a number");o[t]=s}return i},unmatrix:function(r,e,t,n){var i,o,s,h,f,a,v,c;if(void 0!==n){if(n!==r.length)throw new Error("unexpected number of pages")}else n=r.length;if(void 0!==e){if(e!==r[0].length)throw new Error("unexpected number of rows")}else e=r[0].length;if(void 0!==t){if(t!==r[0][0].length)throw new Error("unexpected number of columns")}else t=r[0][0].length;if(e*t*n===0)throw new Error("cannot convert empty matrix");for(c=e*t,h=new Array(e*t*n),s=0;s<n;s++){if(r[s].length!==e)throw new Error("all pages must have same number of rows");for(i=0;i<e;i++){if(f=r[s][i],f.length!==t)throw new Error("all rows must have same number of columns");for(o=0;o<t;o++){if(v=f[o],"number"!=typeof v)throw new Error("entry must be a number");h[i+o*e+s*c]=v}}}return L2.assert.maxEnt(h.length),a=new L2.ArJSA(h),a.r=e,a.c=t,a.p=n,a}},L2.P._twoMatExtras=function(r,e,t){var n,i,o,s,h={};if(this.z){if(this.rk){e.rk={};for(n in this.rk)e.rk[n]=this.rk[n]}if(this.pk&&this.p===e.p){e.pk={};for(n in this.pk)e.pk[n]=this.pk[n]}this.e&&(this.e.rl&&(h.rl=this.e.rl),this.e.rf&&(h.rf=this.e.rf),this.p===e.p&&(this.e.pl&&(h.pl=this.e.pl),this.e.pf&&(h.pf=this.e.pf))),e.z=!0}if(r.z){if(i=t?r.rk:r.ck){e.ck={};for(n in i)e.ck[n]=i[n]}r.e&&((o=t?r.e.rl:r.e.cl)&&(h.cl=o),(s=t?r.e.rf:r.e.cf)&&(h.cf=s)),e.z=!0}L2.aux.isEmpty(h)||(e.e=h)},L2.P._shell=function(r){var e=new L2.ArShell(this);if(e.v=new Array(e.r*e.c*e.p),void 0!==r)for(var t=0,n=e.r*e.c*e.p;t<n;t++)e.v[t]=r;return e},L2.P._remRedExtras=function(r){return this.e&&(delete this.e[r+"l"],delete this.e[r+"f"],delete this.e.ef,delete this.e.t,delete this.e.i,L2.aux.isEmpty(this.e)&&delete this.e),this},L2.P._n=function(r){if(r=(""+r).toLowerCase(),"e"===r)return this.v.length;if("r"===r||"c"===r||"p"===r)return this[r];throw new Error("invalid suffix")},L2.P._appendSc=function(r,e,t,n){var i;if(L2.assert.maxEnt(this.v.length+1),i=t?new L2.ArCopy(this,(!1)):n?this:new L2.ArCopy(this,(!0)),i.z&&i[e+"k"])throw new Error("cannot append scalar on dimension with keys");if("r"===e&&(1!==i.c||1!==i.p)||"c"===e&&(1!==i.r||1!==i.p)||"p"===e&&(1!==i.r||1!==i.c))throw new Error(L2.errorMsg.shapeMismatch);return i[e]++,t?i.v.unshift(r):i.v.push(r),i},L2.P._appendAr=function(r,e,t,n){L2.assert.maxEnt(this.v.length+r.v.length);var i,o,s,h,f,a,v,c,u=new L2.ArShell(this),l=e+"k";if(u[l]){if(!r[l])throw new Error("second table has no "+L2.aux.expandDim[e]+" keys");if(!L2.aux.mutExProps(u[l],r[l]))throw new Error(L2.errorMsg.dupKey);if(t){for(i in r[l])u[l][i]=r[l][i];for(i in this[l])u[l][i]=this[l][i]+r[e]}else for(i in r[l])u[l][i]=r[l][i]+this[e]}switch(e){case"r":if(u.c!==r.c||u.p!==r.p)throw new Error(L2.errorMsg.shapeMismatch);c=u.c*u.p,a=u.r,v=r.r;break;case"c":if(u.r!==r.r||u.p!==r.p)throw new Error(L2.errorMsg.shapeMismatch);c=u.p,a=u.r*u.c,v=r.r*r.c;break;default:if(u.r!==r.r||u.c!==r.c)throw new Error(L2.errorMsg.shapeMismatch);c=1,a=this.v.length,v=r.v.length}if(u[e]+=r[e],u.v=new Array(this.v.length+r.v.length),i=o=s=h=0,t)for(;i<c;i++){for(f=s+v;s<f;s++)u.v[h++]=r.v[s];for(f=o+a;o<f;o++)u.v[h++]=this.v[o]}else for(;i<c;i++){for(f=o+a;o<f;o++)u.v[h++]=this.v[o];for(f=s+v;s<f;s++)u.v[h++]=r.v[s]}return n?(this.v=u.v,this[e]=u[e],this[l]=u[l],this):u},L2.P._dPush=function(r,e){if(!this.rk||1!==this.c||1!==this.p)throw new Error("dictionary expected");if(void 0===r)throw new Error(L2.errorMsg.undefAsKey);var t=this.rk[r];if("number"==typeof t)this.v[t]=e;else{var n=this.v.length;L2.assert.maxEnt(n+1),this.rk[r]=n,this.v[n]=e,this.r++}return this},L2.P._dEnt=function(r){if(!this.rk||1!==this.c||1!==this.p)throw new Error("dictionary expected");if(void 0===r)throw new Error(L2.errorMsg.undefAsKey);var e=this.rk[r];if("number"==typeof e)return this.v[e];throw new Error("key does not exist")},L2.P._setRand=function(r){var e=0,t=this.v.length;if(void 0!==r)for(L2.assert.nonNegInt(r),e;e<t;e++)this.v[e]=Math.floor(Math.random()*(1+ +r));else for(e;e<t;e++)this.v[e]=Math.random();return this},L2.P._len=function(){var r=new L2.ArShell(this),e=this.v.length;r.v=new Array(e);for(var t=0;t<e;t++)r.v[t]=this.v[t].length;return r},L2.P._getInd=function(r,e){if("number"==typeof r){if(Math.round(r)!==r)throw new Error("integer expected");if(r<0&&(r=this[e]+r),r>=this[e]||r<0)throw new Error("index out of bounds")}else{if(void 0===r)throw new Error(L2.errorMsg.undefAsKey);switch(e){case"r":if(!this.rk)throw new Error("table does not have row keys");r=this.rk[r];break;case"c":if(!this.ck)throw new Error("table does not have column keys");r=this.ck[r];break;default:if(!this.pk)throw new Error("table does not have page keys");r=this.pk[r]}if("number"!=typeof r)throw new Error("key does not exist")}return r},L2.P._getKey=function(r,e){var t=this[e+"k"];for(var n in t)if(t[n]===r)return n},L2.P._getIndLin=function(r){var e;if(e=this.v.length,"number"==typeof r){if(Math.round(r)!==r)throw new Error("integer expected");if(r<0&&(r=e+r),r>=e||r<0)throw new Error("index out of bounds")}else{if(!this.rk)throw new Error("table does not have row keys");if(void 0===r)throw new Error(L2.errorMsg.undefAsKey);if(r=this.rk[r],"number"!=typeof r||0===e)throw new Error("key does not exist or table is empty")}return r},L2.P["_e:"]=function(r,e,t,n){if(0===this.v.length)throw new Error("non-empty table expected");return 3===arguments.length?this.v[this._getInd(r,"r")+this._getInd(e,"c")*this.r]=t:this.v[this._getInd(r,"r")+this._getInd(e,"c")*this.r+this._getInd(t,"p")*this.r*this.c]=n,this},L2.P._e=function(r,e,t){if(0===this.v.length)throw new Error("non-empty table expected");return 2===arguments.length?this.v[this._getInd(r,"r")+this._getInd(e,"c")*this.r]:this.v[this._getInd(r,"r")+this._getInd(e,"c")*this.r+this._getInd(t,"p")*this.r*this.c]},L2.P._vEnt=function(r){return this.v[this._getIndLin(r)]},L2.P["_vEnt:"]=function(r,e){return this.v[this._getIndLin(r)]=e,this},L2.P._slashCheckInd=function(r,e){return r>=0&&r<e&&Math.round(r)===r},L2.P._slashEnt2=function(r,e){if(r=+r,e=+e,this._slashCheckInd(r,this.r)&&this._slashCheckInd(e,this.c))return this.v[r+e*this.r]},L2.P._slashEnt3=function(r,e,t){if(r=+r,e=+e,t=+t,this._slashCheckInd(r,this.r)&&this._slashCheckInd(e,this.c)&&this._slashCheckInd(t,this.p))return this.v[r+e*this.r+t*this.r*this.c]},L2.P["_slashEnt1:"]=function(r,e){return r=+r,this._slashCheckInd(r,this.v.length)&&(this.v[r]=e),this},L2.P["_slashEnt2:"]=function(r,e,t){return r=+r,e=+e,this._slashCheckInd(r,this.r)&&this._slashCheckInd(e,this.c)&&0!==this.p&&(this.v[r+e*this.r]=t),this},L2.P["_slashEnt3:"]=function(r,e,t,n){return r=+r,e=+e,t=+t,this._slashCheckInd(r,this.r)&&this._slashCheckInd(e,this.c)&&this._slashCheckInd(t,this.p)&&(this.v[r+e*this.r+t*this.r*this.c]=n),this},L2.P._barEnt1=function(r){return this.v[this.rk[r]]},L2.P._barEnt2=function(r,e){return this.v[this.rk[r]+this.ck[e]*this.r]},L2.P._barEnt3=function(r,e,t){return this.v[this.rk[r]+this.ck[e]*this.r+this.pk[t]*this.r*this.c]},L2.P["_barEnt1:"]=function(r,e){var t=this.rk[r];return 0!==this.v.length&&"number"==typeof t&&(this.v[t]=e),this},L2.P["_barEnt2:"]=function(r,e,t){var n=this.rk[r],i=this.ck[e];return 0!==this.p&&"number"==typeof n&&"number"==typeof i&&(this.v[n+i*this.r]=t),this},L2.P["_barEnt3:"]=function(r,e,t,n){var i=this.rk[r],o=this.ck[e],s=this.pk[t];return"number"==typeof i&&"number"==typeof o&&"number"==typeof s&&(this.v[i+o*this.r+s*this.r*this.c]=n),this},L2.P["_v:"]=function(r,e){var t,n,i=this.v.length;if(1===arguments.length)if(r instanceof L2.Ar)if(n=r.v.length,1===n)for(t=0;t<i;t++)this.v[t]=r.v[0];else{if(n!==i)throw new Error(L2.errorMsg.shapeMismatch);for(t=0;t<i;t++)this.v[t]=r.v[t]}else for(t=0;t<i;t++)this.v[t]=r;else if(r instanceof L2.Ar){n=r.v.length;var o=new Array(n);for(t=0;t<n;t++)o[t]=this._getIndLin(r.v[t]);if(e instanceof L2.Ar){var s=e.v.length;if(1===s)for(t=0;t<n;t++)this.v[o[t]]=e.v[0];else{if(s!==n)throw new Error(L2.errorMsg.shapeMismatch);for(t=0;t<n;t++)this.v[o[t]]=e.v[t]}}else for(t=0;t<n;t++)this.v[o[t]]=e}else{if(e instanceof L2.Ar){if(1!==e.v.length)throw new Error(L2.errorMsg.shapeMismatch);e=e.v[0]}this.v[this._getIndLin(r)]=e}return this},L2.P._v=function(r){var e,t,n,i=this.v.length;if(0===arguments.length){for(t=new L2.Ar(i,(void 0),(!0)),e=0;e<i;e++)t.v[e]=this.v[e];return t}if(r instanceof L2.Ar){for(n=r.v.length,t=new L2.Ar(n,(void 0),(!0)),e=0;e<n;e++)t.v[e]=this.v[this._getIndLin(r.v[e])];return t}return new L2.ArJSA([this.v[this._getIndLin(r)]])},L2.P["_vrcp:"]=function(r,e,t,n){var i,o,s,h,f;if(o=r.v.length,e.v.length!==o)throw new Error(L2.errorMsg.shapeMismatch);if(h=new Array(o),arguments.length>3){if(t.v.length!==o)throw new Error(L2.errorMsg.shapeMismatch);for(i=0;i<o;i++)h[i]=this._getInd(r.v[i],"r")+this._getInd(e.v[i],"c")*this.r+this._getInd(t.v[i],"p")*this.r*this.c}else{if(0===this.p&&0!==o)throw new Error("non-empty table expected");for(i=0;i<o;i++)h[i]=this._getInd(r.v[i],"r")+this._getInd(e.v[i],"c")*this.r;n=t}if(n instanceof L2.Ar)if(s=n.v.length,1===s)for(f=n.v[0],i=0;i<o;i++)this.v[h[i]]=f;else{if(s!==o)throw new Error(L2.errorMsg.shapeMismatch);for(i=0;i<o;i++)this.v[h[i]]=n.v[i]}else for(i=0;i<o;i++)this.v[h[i]]=n;return this},L2.P._vrcp=function(r,e,t){var n,i,o;if(i=r.v.length,e.v.length!==i)throw new Error(L2.errorMsg.shapeMismatch);if(o=new Array(i),arguments.length>2){if(t.v.length!==i)throw new Error(L2.errorMsg.shapeMismatch);for(n=0;n<i;n++)o[n]=this.v[this._getInd(r.v[n],"r")+this._getInd(e.v[n],"c")*this.r+this._getInd(t.v[n],"p")*this.r*this.c]}else{if(0===this.p&&0!==i)throw new Error("non-empty table expected");for(n=0;n<i;n++)o[n]=this.v[this._getInd(r.v[n],"r")+this._getInd(e.v[n],"c")*this.r]}return new L2.ArJSA(o)},L2.P._oneDimSc=function(r,e,t){if(arguments.length>=3&&"cut"!==t)throw new Error("argument must be 'cut'");var n,i,o,s,h,f,a,v,c=new L2.ArShell(this,r),u=r+"k",l=0,w=c.r*c.c;if(i=this._getInd(e,r),this[u]&&(o="number"==typeof e?this._getKey(i,r):e,c[u]={},c[u][o]=0,t)){delete this[u][o];for(s in this[u])n=this[u][s],n>i&&(this[u][s]=n-1)}if("r"===r){for(c.v=new Array(c.c*c.p),f=0;f<c.p;f++)for(h=0;h<c.c;h++)c.v[l++]=this.v[i+h*c.r+f*w];if(t)for(l=0,v=new Array(this.v.length-c.v.length),f=0;f<c.p;f++)for(h=0;h<c.c;h++)for(s=0;s<c.r;s++)s!==i&&(v[l++]=this.v[s+h*c.r+f*w])}else if("c"===r){for(c.v=new Array(c.r*c.p),a=i*c.r,f=0;f<c.p;f++)for(s=0;s<c.r;s++)c.v[l++]=this.v[s+a+f*w];if(t)for(l=0,v=new Array(this.v.length-c.v.length),f=0;f<c.p;f++)for(h=0;h<c.c;h++)if(h!==i)for(s=0;s<c.r;s++)v[l++]=this.v[s+h*c.r+f*w]}else{for(c.v=new Array(w),s=i*w;s<(i+1)*w;s++)c.v[l++]=this.v[s];if(t){for(l=0,v=new Array(this.v.length-c.v.length),s=0;s<i*w;s++)v[l++]=this.v[s];for(s=(i+1)*w;s<this.v.length;s++)v[l++]=this.v[s]}}return c[r]=1,t&&(this[r]--,this.v=v),c},L2.P._oneDimAr=function(r,e,t){if(arguments.length>=3&&"cut"!==t)throw new Error("argument must be 'cut'");var n=e.v.length;if(1===n)return t?this._oneDimSc(r,e.v[0],t):this._oneDimSc(r,e.v[0]);var i,o,s,h,f,a,v,c,u,l,w,p=new L2.ArShell(this,r),L=r+"k",g=0,d=p.r*p.c;o=new Array(n);for(var v=0;v<n;v++)o[v]=this._getInd(e.v[v],r);if(t){if(!L2.aux.uniqueJSA_strEq(o))throw new Error("repeats not permitted when cutting");for(s=new Array(n),v=0;v<n;v++)s[v]=o[v];for(s.sort(function(r,e){return r-e}),h=p[r]-n,f=new Array(h),i=0,v=0;v<p[r];v++)v===s[i]?i++:f[g++]=v;g=0}if(this[L]){p[L]={},
a=new Array(n);for(var v=0;v<n;v++)a[v]="number"==typeof e.v[v]?this._getKey(o[v],r):e.v[v],p[L][a[v]]=v;if(t){for(v=0;v<n;v++)delete this[L][a[v]];for(v in this[L]){for(i=0,c=0;c<n&&s[c]<this[L][v];c++)i++;this[L][v]-=i}}else if(!L2.aux.uniqueJSA_strEq(o))throw new Error(L2.errorMsg.dupKey)}if("r"===r){for(L2.assert.maxEnt(w=n*p.c*p.p),p.v=new Array(w),u=0;u<p.p;u++)for(c=0;c<p.c;c++)for(v=0;v<n;v++)p.v[g++]=this.v[o[v]+c*p.r+u*d];if(t)for(l=new Array(this.v.length-p.v.length),g=0,u=0;u<p.p;u++)for(c=0;c<p.c;c++)for(v=0;v<h;v++)l[g++]=this.v[f[v]+c*p.r+u*d]}else if("c"===r){for(L2.assert.maxEnt(w=p.r*n*p.p),p.v=new Array(w),u=0;u<p.p;u++)for(c=0;c<n;c++)for(v=0;v<p.r;v++)p.v[g++]=this.v[v+o[c]*p.r+u*d];if(t)for(l=new Array(this.v.length-p.v.length),g=0,u=0;u<p.p;u++)for(c=0;c<h;c++)for(v=0;v<p.r;v++)l[g++]=this.v[v+f[c]*p.r+u*d]}else{for(L2.assert.maxEnt(w=d*n),p.v=new Array(w),u=0;u<n;u++)for(v=o[u]*d;v<(o[u]+1)*d;v++)p.v[g++]=this.v[v];if(t)for(l=new Array(this.v.length-p.v.length),g=0,u=0;u<h;u++)for(v=f[u]*d;v<(f[u]+1)*d;v++)l[g++]=this.v[v]}return p[r]=n,t&&(this[r]-=n,this.v=l),p},L2.P._twoDim=function(r,e,t,n){for(var i,o,s,h,f,a,v=new L2.ArShell(this,r),c=0,u=v.r*v.c,l=t.v.length,i=new Array(l),w=r+"k",p=n.v.length,o=new Array(p),L=e+"k",s=0;s<l;s++)i[s]=this._getInd(t.v[s],r);for(var s=0;s<p;s++)o[s]=this._getInd(n.v[s],e);if(this[w]){v[w]={};for(var s=0;s<l;s++)v[w]["number"==typeof t.v[s]?this._getKey(i[s],r):t.v[s]]=s;if(!L2.aux.uniqueJSA_strEq(i))throw new Error(L2.errorMsg.dupKey)}if(this[L]){v[L]={};for(var s=0;s<p;s++)v[L]["number"==typeof n.v[s]?this._getKey(o[s],e):n.v[s]]=s;if(!L2.aux.uniqueJSA_strEq(o))throw new Error(L2.errorMsg.dupKey)}if("r"===r&&"c"===e)for(L2.assert.maxEnt(a=l*p*v.p),v.v=new Array(a),f=0;f<v.p;f++)for(h=0;h<p;h++)for(s=0;s<l;s++)v.v[c++]=this.v[i[s]+o[h]*v.r+f*u];else if("r"===r&&"p"===e)for(L2.assert.maxEnt(a=l*v.c*p),v.v=new Array(a),f=0;f<p;f++)for(h=0;h<v.c;h++)for(s=0;s<l;s++)v.v[c++]=this.v[i[s]+h*v.r+o[f]*u];else for(L2.assert.maxEnt(a=v.r*l*p),v.v=new Array(a),f=0;f<p;f++)for(h=0;h<l;h++)for(s=0;s<v.r;s++)v.v[c++]=this.v[s+i[h]*v.r+o[f]*u];return v[r]=l,v[e]=p,v},L2.P._threeDim=function(r,e,t){for(var n,i,o,s,h,f,a,v=new L2.ArShell(this,"r"),c=0,u=v.r*v.c,l=r.v.length,n=new Array(l),w=e.v.length,i=new Array(w),p=t.v.length,o=new Array(p),s=0;s<l;s++)n[s]=this._getInd(r.v[s],"r");for(var s=0;s<w;s++)i[s]=this._getInd(e.v[s],"c");for(var s=0;s<p;s++)o[s]=this._getInd(t.v[s],"p");if(this.rk){v.rk={};for(var s=0;s<l;s++)v.rk["number"==typeof r.v[s]?this._getKey(n[s],"r"):r.v[s]]=s;if(!L2.aux.uniqueJSA_strEq(n))throw new Error(L2.errorMsg.dupKey)}if(this.ck){v.ck={};for(var s=0;s<w;s++)v.ck["number"==typeof e.v[s]?this._getKey(i[s],"c"):e.v[s]]=s;if(!L2.aux.uniqueJSA_strEq(i))throw new Error(L2.errorMsg.dupKey)}if(this.pk){v.pk={};for(var s=0;s<p;s++)v.pk["number"==typeof t.v[s]?this._getKey(o[s],"p"):t.v[s]]=s;if(!L2.aux.uniqueJSA_strEq(o))throw new Error(L2.errorMsg.dupKey)}for(L2.assert.maxEnt(a=l*w*p),v.v=new Array(a),f=0;f<p;f++)for(h=0;h<w;h++)for(s=0;s<l;s++)v.v[c++]=this.v[n[s]+i[h]*v.r+o[f]*u];return v.r=l,v.c=w,v.p=p,v},L2.P._oneDimSetSc=function(r,e,t){var n=e.v.length;if(0===n)return this;var i,o,s,h,f=this.r*this.c;for(i=new Array(n),o=0;o<n;o++)i[o]=this._getInd(e.v[o],r);if("r"===r)for(h=0;h<this.p;h++)for(s=0;s<this.c;s++)for(o=0;o<n;o++)this.v[i[o]+s*this.r+h*f]=t;else if("c"===r)for(h=0;h<this.p;h++)for(s=0;s<n;s++)for(o=0;o<this.r;o++)this.v[o+i[s]*this.r+h*f]=t;else for(h=0;h<n;h++)for(o=i[h]*f;o<(i[h]+1)*f;o++)this.v[o]=t;return this},L2.P._oneDimSetAr=function(r,e,t){if(1===t.v.length)return this._oneDimSetSc(r,e,t.v[0]);var n,i,o,s,h=e.v.length,f=0,a=this.r*this.c;for(n=new Array(h),i=0;i<h;i++)n[i]=this._getInd(e.v[i],r);if("r"===r){if(h!==t.r||this.c!==t.c||this.p!==t.p)throw new Error(L2.errorMsg.shapeMismatch);for(s=0;s<this.p;s++)for(o=0;o<this.c;o++)for(i=0;i<h;i++)this.v[n[i]+o*this.r+s*a]=t.v[f++]}else if("c"===r){if(this.r!==t.r||h!==t.c||this.p!==t.p)throw new Error(L2.errorMsg.shapeMismatch);for(s=0;s<this.p;s++)for(o=0;o<h;o++)for(i=0;i<this.r;i++)this.v[i+n[o]*this.r+s*a]=t.v[f++]}else{if(this.r!==t.r||this.c!==t.c||h!==t.p)throw new Error(L2.errorMsg.shapeMismatch);for(s=0;s<h;s++)for(i=n[s]*a;i<(n[s]+1)*a;i++)this.v[i]=t.v[f++]}return this},L2.P._twoDimSet=function(r,e,t,n,i){for(var o,s,h,f,a,v=0,c=this.r*this.c,u=null,l=t.v.length,o=new Array(l),w=n.v.length,s=new Array(w),h=0;h<l;h++)o[h]=this._getInd(t.v[h],r);for(var h=0;h<w;h++)s[h]=this._getInd(n.v[h],e);if(i instanceof L2.Ar?1===i.v.length&&(u=i.v[0]):u=i,null!==u)if("r"===r&&"c"===e)for(a=0;a<this.p;a++)for(f=0;f<w;f++)for(h=0;h<l;h++)this.v[o[h]+s[f]*this.r+a*c]=u;else if("r"===r&&"p"===e)for(a=0;a<w;a++)for(f=0;f<this.c;f++)for(h=0;h<l;h++)this.v[o[h]+f*this.r+s[a]*c]=u;else for(a=0;a<w;a++)for(f=0;f<l;f++)for(h=0;h<this.r;h++)this.v[h+o[f]*this.r+s[a]*c]=u;else if("r"===r&&"c"===e){if(l!==i.r||w!==i.c||this.p!==i.p)throw new Error(L2.errorMsg.shapeMismatch);for(a=0;a<this.p;a++)for(f=0;f<w;f++)for(h=0;h<l;h++)this.v[o[h]+s[f]*this.r+a*c]=i.v[v++]}else if("r"===r&&"p"===e){if(l!==i.r||this.c!==i.c||w!==i.p)throw new Error(L2.errorMsg.shapeMismatch);for(a=0;a<w;a++)for(f=0;f<this.c;f++)for(h=0;h<l;h++)this.v[o[h]+f*this.r+s[a]*c]=i.v[v++]}else{if(this.r!==i.r||l!==i.c||w!==i.p)throw new Error(L2.errorMsg.shapeMismatch);for(a=0;a<w;a++)for(f=0;f<l;f++)for(h=0;h<this.r;h++)this.v[h+o[f]*this.r+s[a]*c]=i.v[v++]}return this},L2.P._threeDimSet=function(r,e,t,n){for(var i,o,s,h,f,a,v=0,c=this.r*this.c,u=null,l=r.v.length,i=new Array(l),w=e.v.length,o=new Array(w),p=t.v.length,s=new Array(p),h=0;h<l;h++)i[h]=this._getInd(r.v[h],"r");for(var h=0;h<w;h++)o[h]=this._getInd(e.v[h],"c");for(var h=0;h<p;h++)s[h]=this._getInd(t.v[h],"p");if(n instanceof L2.Ar?1===n.v.length&&(u=n.v[0]):u=n,null!==u)for(a=0;a<p;a++)for(f=0;f<w;f++)for(h=0;h<l;h++)this.v[i[h]+o[f]*this.r+s[a]*c]=u;else{if(l!==n.r||w!==n.c||p!==n.p)throw new Error(L2.errorMsg.shapeMismatch);for(a=0;a<p;a++)for(f=0;f<w;f++)for(h=0;h<l;h++)this.v[i[h]+o[f]*this.r+s[a]*c]=n.v[v++]}return this},L2.P._map=function(r){var e=new L2.ArShell(this),t=this.v.length;e.v=new Array(t);for(var n=0;n<t;n++)e.v[n]=r(this.v[n]);return e},L2.P._map_1_as=function(r,e){var t=new L2.ArShell(this),n=this.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r(this.v[i],e);return t},L2.P._map_1_sa=function(r,e){for(var t=this.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r(e,this.v[i]);var o=new L2.ArJSA(n);return o.r=this.r,o.c=this.c,o.p=this.p,o},L2.P._map_1_aa=function(r,e){var t=this.v.length,n=e.v.length;if(1===n)return this._map_1_as(r,e.v[0]);if(1===t)return e._map_1_sa(r,this.v[0]);if(this.r!==e.r||this.c!==e.c||this.p!==e.p)throw new Error(L2.errorMsg.shapeMismatch);var i=new L2.ArShell(this);i.v=new Array(t);for(var o=0;o<t;o++)i.v[o]=r(this.v[o],e.v[o]);return i},L2.P._mapMeth=function(r){var e=new L2.ArShell(this),t=this.v.length;e.v=new Array(t);for(var n=0;n<t;n++)e.v[n]=this.v[n][r]();return e},L2.P._mapMeth_as=function(r,e){var t=new L2.ArShell(this),n=this.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=this.v[i][r](e);return t},L2.P._mapMeth_sa=function(r,e){for(var t=this.v.length,n=new Array(t),i=0;i<t;i++)n[i]=e[r](this.v[i]);var o=new L2.ArJSA(n);return o.r=this.r,o.c=this.c,o.p=this.p,o},L2.P._mapMeth_aa=function(r,e){var t=this.v.length,n=e.v.length;if(1===n)return this._mapMeth_as(r,e.v[0]);if(1===t)return e._mapMeth_sa(r,this.v[0]);if(this.r!==e.r||this.c!==e.c||this.p!==e.p)throw new Error(L2.errorMsg.shapeMismatch);var i=new L2.ArShell(this);i.v=new Array(t);for(var o=0;o<t;o++)i.v[o]=this.v[o][r](e.v[o]);return i},L2.P._mapMeth_ass=function(r,e,t){var n=new L2.ArShell(this),i=this.v.length;n.v=new Array(i);for(var o=0;o<i;o++)n.v[o]=this.v[o][r](e,t);return n},L2.P._mapMeth_date=function(r,e,t,n,i){var o,s=new L2.ArShell(this),h=this.v.length,f=arguments.length;switch(s.v=new Array(h),f){case 2:for(o=0;o<h;o++)s.v[o]=new Date(new Date(this.v[o])[r](e));break;case 3:for(o=0;o<h;o++)s.v[o]=new Date(new Date(this.v[o])[r](e,t));break;case 4:for(o=0;o<h;o++)s.v[o]=new Date(new Date(this.v[o])[r](e,t,n));break;default:for(o=0;o<h;o++)s.v[o]=new Date(new Date(this.v[o])[r](e,t,n,i))}return s},L2.P["!"]=function(){var r=new L2.ArShell(this),e=this.v.length;r.v=new Array(e);for(var t=0;t<e;t++)r.v[t]=!this.v[t];return r},L2.P._unary=function(){var r=new L2.ArShell(this),e=this.v.length;r.v=new Array(e);for(var t=0;t<e;t++)r.v[t]=-this.v[t];return r},L2.symb={},L2.symb.as={"+":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]+e;return t},"-":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]-e;return t},"*":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]*e;return t},"/":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]/e;return t},"%":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]%e;return t},"==":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]===e;return t},"!=":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]!==e;return t},"<":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]<e;return t},"<=":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]<=e;return t},">":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]>e;return t},">=":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]>=e;return t},"&&":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]&&e;return t},"||":function(r,e){var t=new L2.ArShell(r),n=r.v.length;t.v=new Array(n);for(var i=0;i<n;i++)t.v[i]=r.v[i]||e;return t}},L2.symb.sa={"+":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r+e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"-":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r-e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"*":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r*e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"/":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r/e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"%":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r%e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"==":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r===e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"!=":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r!==e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"<":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r<e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"<=":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r<=e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},">":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r>e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},">=":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r>=e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"&&":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r&&e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o},"||":function(r,e){for(var t=e.v.length,n=new Array(t),i=0;i<t;i++)n[i]=r||e.v[i];var o=new L2.ArJSA(n);return o.r=e.r,o.c=e.c,o.p=e.p,o}},L2.symb.aa={apply:function(r,e,t){var n=e.v.length,i=t.v.length;if(1===i)return L2.symb.as[r](e,t.v[0]);if(1===n)return L2.symb.sa[r](e.v[0],t);if(e.r!==t.r||e.c!==t.c||e.p!==t.p)throw new Error(L2.errorMsg.shapeMismatch);var o=new L2.ArShell(e);return o.v=L2.symb.aa[r](e.v,t.v),o},"+":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]+e[i];return n},"-":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]-e[i];return n},"*":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]*e[i];return n},"/":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]/e[i];return n},"%":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]%e[i];return n},"==":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]===e[i];return n},"!=":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]!==e[i];return n},"<":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]<e[i];return n},"<=":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]<=e[i];return n},">":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]>e[i];return n},">=":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]>=e[i];return n},"&&":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]&&e[i];return n},"||":function(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;i++)n[i]=r[i]||e[i];return n}},L2.symb.logic={"||":function(r,e){return r||e},"&&":function(r,e){return r&&e}},L2.sketch={combineList:{arc:1,ellipse:1,segment:1,spot:1,quad:1,rect:1,triangle:1,fill:1,stroke:1,resetMatrix:1,rotateX:1,rotateY:1,rotateZ:1,rotate:1,scale:1,shearX:1,shearY:1,translate:1,text:1,textFont:1,plane:1,cuboid:1,sphere:1,cylinder:1,cone:1,ellipsoid:1,torus:1,strokeWeight:1,textAlign:1,textLeading:1,textSize:1,textStyle:1,curveTightness:1,circle:1,background:1,colorMode:1,ellipseMode:1,rectMode:1,strokeCap:1,strokeJoin:1,redraw:1,camera:1,perspective:1,ortho:1,ambientLight:1,directionalLight:1,pointLight:1,normalMaterial:1,ambientMaterial:1,specularMaterial:1,erase:1,noFill:1,noStroke:1,noSmooth:1,smooth:1,discard:1,pause:1,play:1,push:1,pop:1,cursor:1,noCursor:1,resizeCanvas:1,noCanvas:1,blendMode:1,createCanvas:1},polyList:{polygon:1,polyline:1,curve:1},changeName:{lastKey:1,lastCode:1,erase:1,discard:1,pause:1,play:1,segment:1,spot:1,cuboid:1,rotate:1,circle:1},suffix:function(r){return this.changeName[r]?"_L2_"+r:r}},L2.node_path&&(L2.srv=require("./srv")),delete L2.P,"nd"!==L2.runningIn&&"nc"!==L2.runningIn||require("./extend");
!function(){var r=function(r,e,n){r instanceof L2.Ar||(r=new L2.ArJSA([r])),e instanceof L2.Ar&&(e=e.v[0]),n instanceof L2.Ar&&(n=n.v[0]);var a=new L2.ArJSA([void 0]);if(void 0===n||"asc"===n||"desc"===n||L2.pf.ew.isFunc(n))a=r.key(L2.aux.validSfx(e,!1)).sort(n);else if("asc-num"===n||"desc-num"===n||"asc-date"===n||"desc-date"===n){var t="a"===L2.pf.ew.str(n).charAt(0)?"asc":"desc";a="m"===n.substr(-1)?r.key(L2.aux.validSfx(e,!1))._map(L2.pf.ew.num).sort(t,"index"):r.key(L2.aux.validSfx(e,!1))._map(L2.pf.ew.date).sort(t,"index")}else L2.ge.error("invalid argument");return"r"===e?r._oneDimAr("r",a):"c"===e?r._oneDimAr("c",a):r._oneDimAr("p",a)};L2.Ar.prototype.sortKey=function(e,n){if(!this[e+"k"])throw new Error("table has no "+L2.aux.expandDim[e]+" keys");if(2===arguments.length&&void 0===n)throw new Error("invalid argument");return r(this,e,n)},L2.Ar.prototype.sortKey.sig={arg:[1],rtn:!0,min:0,dim:1};var e=function(r){return r instanceof L2.Ar||(r=new L2.ArJSA([r])),0===r.v.length?L2.aux.prt(r):L2.aux.prt(r._threeDim(L2.sc.range(0,L2.pf.math["<>"](r.r-1,4)),L2.sc.range(0,L2.pf.math["<>"](r.c-1,4)),L2.sc.range(0,L2.pf.math["<>"](r.p-1,1)))),r};L2.Ar.prototype._peek=function(){return e(this)};var n=function(r,e,n){return r instanceof L2.Ar||(r=new L2.ArJSA([r])),e instanceof L2.Ar&&(e=e.v[0]),n instanceof L2.Ar&&(n=n.v[0]),r._oneDimAr("r",r._oneDimSc("c",e).sort(n,"index"))},a=function(r,e,n){if(r instanceof L2.Ar||(r=new L2.ArJSA([r])),e instanceof L2.Ar||(e=new L2.ArJSA([e])),n instanceof L2.Ar||(n=new L2.ArJSA([n])),0===r.r)return new L2.ArCopy(r,(!0));1===n.v.length&&(n=new L2.Ar(e.v.length,n.v[0]));var a=new L2.Ar(r.r),t=0,L=function(i,o){i instanceof L2.Ar||(i=new L2.ArJSA([i])),o instanceof L2.Ar&&(o=o.v[0]);var s=new L2.ArJSA([void 0]);if(0===arguments.length){o=0;var A=e.v[0];s=r._oneDimSc("c",A).sort(n.v[0],"index")}else A=e.v[+o],s=i._oneDimAr("r",r._twoDim("r","c",i,new L2.ArJSA([A])).sort(n.v[+o],"index"));if(L2.pf.ew.isFunc(n.v[+o]))var p=n.v[+o];for(var c=r._slashEnt2(s.v[0],A),f=0,v=s.r-1,w=new L2.ArJSA([]),m=1;m<=v;m+=1){var l=r._slashEnt2(s.v[+m],A);(!p&&(l<c||l>c)||p&&(0!==L2.sca(p(c,l))||0!==L2.sca(p(l,c))))&&(w._appendSc(m-f>1?new L2.Box(s.slice("r",f,m-1)):s.v[+f],"r",!1,!0),c=l,f=m)}w._appendSc(m-f>1?new L2.Box(s.slice("r",f,m-1)):s.v[+f],"r",!1,!0);for(var S=0,u=w.v.length,d=w.v[0];S<u;d=w.v[++S])L2.pf.ew.isBox(d)?o<e.v.length-1?L2.tab(L(L2.sc.unwrap(d),o+1)):(a["slice:"]("r",t,t+L2.sc.unwrap(d).r-1,L2.sc.unwrap(d)),t+=L2.sc.unwrap(d).r):(a["_slashEnt1:"](t,d),t+=1)};return L2.tab(L()),r._oneDimAr("r",a)};L2.Ar.prototype.order=function(r,e){L2.assert.dataMatrix(this);var t,L,i;if(2===arguments.length){if(0===e.v.length)throw new Error("non-empty table expected");for(t=0,L=e.v.length;t<L;t++)if(i=e.v[t],"desc"!==i&&"asc"!==i&&"function"!=typeof i)throw new Error("'asc', 'desc' or function expected")}else e=new L2.ArJSA(["asc"]);if(0===r.v.length)throw new Error("must specify at least 1 column");if(1===r.v.length){if(1!==e.v.length)throw new Error(L2.errorMsg.shapeMismatch);return n(this,r.v[0],e.v[0])}if(1!==e.v.length&&e.v.length!==r.v.length)throw new Error(L2.errorMsg.shapeMismatch);for(r=L2.aux.colInd(this,r),t=1,L=r.v.length;t<L;t++)L2.assert.homogType(this,r.v[t]);return a(this,r,e)},L2.Ar.prototype.order.sig={arg:[2,2],rtn:!0,min:1,dim:0};var t=function(r,e,n,a){r instanceof L2.Ar||(r=new L2.ArJSA([r])),e instanceof L2.Ar||(e=new L2.ArJSA([e])),n instanceof L2.Ar||(n=new L2.ArJSA([n])),a instanceof L2.Ar&&(a=a.v[0]);var t=new L2.ArJSA([void 0]),L=new L2.ArJSA([void 0]),i=new L2.ArJSA([void 0]);L2.ge.isNil(e)&&(e=L2.sc.range(0,r.c-1)),n=n._v();var o=n._map(L2.pf.ew.num),s=r.r,A=e.r,p=o.r-1;0===A&&L2.ge.error("must specify at least 1 column (pass ~ to use all)"),p<1&&L2.ge.error("at least 1 bin (2 limits) expected"),(o._map(L2.pf.ew.isNaN).any("r").v[0]||L2.symb.as["<="](L2.symb.aa.apply("-",o.slice("r",1,-1),o.slice("r",0,-2)),0).any("r").v[0])&&L2.ge.error("limits must convert to increasing numbers");var c=new L2.ArSh(new L2.ArJSA([p,A]),0),f=r.z;if(f&&(r.hasKey("c")&&c["key:"]("c",void 0,r.key("c")._oneDimAr("r",e)),c["label:"]("c",r.label("c"))["fmt:"]("c",r.fmt("c"))["key:"]("p",void 0,r.key("p"))["label:"]("p",r.label("p"))["fmt:"]("p",r.fmt("p"))),a){t=new L2.Ar(p);for(var v=0;v<=p-1;v+=1)t["_slashEnt1:"](v,L2.sca(a(n.v[+v],n.v[+(v+1)],v)))}else t=L2.symb.as["+"](L2.symb.aa.apply("+",L2.symb.as["+"](L2.symb.sa["+"]("(",n.slice("r",0,-2)),","),n.slice("r",1,-1)),"]"),t["_slashEnt1:"](0,t.v[0].replaceStr("(","["));if(c["key:"]("r",void 0,t),s)for(var w=0,m=e.v.length,l=e.v[0];w<m;l=e.v[++w]){L=r._oneDimSc("c",l)._map(L2.pf.ew.num).asc(),i=new L2.Ar(p,0);var S=1,u=o.v[+S],d=0;for(L.v[0]<o.v[0]&&L2.ge.error("data value less than lowest limit"),v=0;v<s;)L.v[+v]>u?(i["_slashEnt1:"](S-1,v-d),d=v,S+=1,S>p&&L2.ge.error("data value greater than highest limit"),u=o.v[+S]):v+=1;i["_slashEnt1:"](S-1,s-d),c._oneDimSetAr("c",new L2.ArJSA([w]),i)}return c};L2.Ar.prototype.bin=function(r,e,n){if(L2.assert.dataMatrix(this),L2.ge.isNil(r)||(r=L2.aux.colInd(this,r)),3===arguments.length&&"function"!=typeof n)throw new Error("function expected");return t(this,r,e,n)},L2.Ar.prototype.bin.sig={arg:[2,2,1],rtn:!0,min:2,dim:0};var L=function(r,e,n){r instanceof L2.Ar||(r=new L2.ArJSA([r])),e instanceof L2.Ar&&(e=e.v[0]),n instanceof L2.Ar||(n=new L2.ArJSA([n]));var a=new L2.ArJSA([void 0]);n=n._map(L2.pf.ew.num)._v(),L2.symb.aa.apply("&&",L2.symb.as[">="](n,0),L2.symb.as["<="](n,1))["!"]().any("r").v[0]&&L2.ge.error("value between 0 and 1 expected");var t=function(r){if(r instanceof L2.Ar||(r=new L2.ArJSA([r])),0===r.v.length)return new L2.Ar(n.r,NaN);r=r._map(L2.pf.ew.num).asc();var e=L2.symb.as["*"](n,r.r-1),a=L2.symb.aa.apply("-",e,e._map(L2.pf.ew.floor));return r._vEnt(0)===-(1/0)||r._vEnt(-1)===1/0?L2.symb.aa.apply("+",L2.symb.aa.apply("*",r._v(e._map(L2.pf.ew.floor)),L2.symb.sa["-"](1,a))["where:"](0,NaN,0),L2.symb.aa.apply("*",r._v(e._map(L2.pf.ew.ceil)),a)["where:"](0,NaN,0)):L2.symb.aa.apply("+",L2.symb.aa.apply("*",r._v(e._map(L2.pf.ew.floor)),L2.symb.sa["-"](1,a)),L2.symb.aa.apply("*",r._v(e._map(L2.pf.ew.ceil)),a))},L=function(e){e instanceof L2.Ar&&(e=e.v[0]),r.hasKey(L2.aux.validSfx(e,!1))&&a["key:"](L2.aux.validSfx(e,!1),void 0,r.key(L2.aux.validSfx(e,!1))),r.label(L2.aux.validSfx(e,!1))&&a["label:"](L2.aux.validSfx(e,!1),r.label(L2.aux.validSfx(e,!1))),r.fmt(L2.aux.validSfx(e,!0))&&a["fmt:"](L2.aux.validSfx(e,!0),r.fmt(L2.aux.validSfx(e,!0)))};if("e"===e)return L2.tab(t(r))["key:"]("r",void 0,n);if("r"===e){if(L2.ge.isVec(r))a=L2.tab(t(r))["key:"]("r",void 0,n);else{a=new L2.ArSh(new L2.ArJSA([n.r,r.c])._appendSc(r.p,"r"))["key:"]("r",void 0,n);for(var i=0,o=r.c;i<o;i++)for(var s=0,A=r.p;s<A;s++)a._twoDimSet("c","p",new L2.ArJSA([i]),new L2.ArJSA([s]),L2.tab(t(r._twoDim("c","p",new L2.ArJSA([i]),new L2.ArJSA([s])))))}L2.tab(L("c")),L2.tab(L("p"))}else if("c"===e){for(a=new L2.ArSh(new L2.ArJSA([r.r,n.r])._appendSc(r.p,"r"))["key:"]("c",void 0,n),i=0,o=r.r;i<o;i++)for(s=0,A=r.p;s<A;s++)a._twoDimSet("r","p",new L2.ArJSA([i]),new L2.ArJSA([s]),new L2.ArTp(L2.tab(t(r._twoDim("r","p",new L2.ArJSA([i]),new L2.ArJSA([s]))))));L2.tab(L("r")),L2.tab(L("p"))}else{for(a=new L2.ArSh(new L2.ArJSA([r.r,r.c])._appendSc(n.r,"r"))["key:"]("p",void 0,n),i=0,o=r.r;i<o;i++)for(s=0,A=r.c;s<A;s++)a._twoDimSet("r","c",new L2.ArJSA([i]),new L2.ArJSA([s]),new L2.ArTp(L2.tab(t(r._twoDim("r","c",new L2.ArJSA([i]),new L2.ArJSA([s])))),"cpr"));L2.tab(L("r")),L2.tab(L("c"))}return a};L2.Ar.prototype.quant=function(r,e){return 1===arguments.length&&(e=new L2.ArJSA([0,.25,.5,.75,1])),L(this,r,e)},L2.Ar.prototype.quant.sig={arg:[2],rtn:!0,min:0,dim:2};var i=function(r,e){r instanceof L2.Ar||(r=new L2.ArJSA([r])),e instanceof L2.Ar&&(e=e.v[0]);var n=new L2.ArJSA([void 0]),a=new L2.ArJSA(["type","finite","mean","sd","min","25%","50%","75%","max"]),t=new L2.ArJSA([0,.25,.5,.75,1]),i=function(r){return r instanceof L2.Ar||(r=new L2.ArJSA([r])),r._map(L2.pf.ew.isFin).all("e").v[0]?new L2.ArJSA(["number",!0,r.mean("e").v[0],r.sd("e").v[0]])._appendAr(L2.tab(L(r,"e",t)),"r"):new L2.ArJSA(["number",!1])._appendAr(new L2.Ar(7,"--"),"r")};if("e"===e){var o=r.homog("e").v[0];n=("number"===o?L2.tab(i(r)):new L2.Ar(8,"--")._appendSc(o,"r",!0))["key:"]("r",void 0,a)}else if("r"===e){n=r.homog("r")._appendAr(new L2.ArSh(new L2.ArJSA([8,r.c])._appendSc(r.p,"r"),"--"),"r")["key:"]("r",void 0,a);for(var s=0,A=r.c;s<A;s++)for(var p=0,c=r.p;p<c;p++)"number"===n._slashEnt3(0,s,p)&&n._twoDimSet("c","p",new L2.ArJSA([s]),new L2.ArJSA([p]),L2.tab(i(r._twoDim("c","p",new L2.ArJSA([s]),new L2.ArJSA([p])))))}else if("c"===e){n=r.homog("c")._appendAr(new L2.ArSh(new L2.ArJSA([r.r,8])._appendSc(r.p,"r"),"--"),"c")["key:"]("c",void 0,a);for(var f=0,v=r.r;f<v;f++)for(p=0,c=r.p;p<c;p++)"number"===n._slashEnt3(f,0,p)&&n._twoDimSet("r","p",new L2.ArJSA([f]),new L2.ArJSA([p]),new L2.ArTp(L2.tab(i(r._twoDim("r","p",new L2.ArJSA([f]),new L2.ArJSA([p]))))))}else for(n=r.homog("p")._appendAr(new L2.ArSh(new L2.ArJSA([r.r,r.c])._appendSc(8,"r"),"--"),"p")["key:"]("p",void 0,a),f=0,v=r.r;f<v;f++)for(s=0,A=r.c;s<A;s++)"number"===n._slashEnt3(f,s,0)&&n._twoDimSet("r","c",new L2.ArJSA([f]),new L2.ArJSA([s]),new L2.ArTp(L2.tab(i(r._twoDim("r","c",new L2.ArJSA([f]),new L2.ArJSA([s])))),"cpr"));return n};L2.Ar.prototype.smry=function(r){return i(this,r)},L2.Ar.prototype.smry.sig={arg:[],rtn:!0,min:0,dim:2};var o=function(r,e){return r instanceof L2.Ar||(r=new L2.ArJSA([r])),e instanceof L2.Ar&&(e=e.v[0]),r=r.r<2?r._shell(NaN):L2.symb.aa.apply("-",r,r.mean("r").to(r)),L2.symb.as["/"](new L2.ArTp(r).mm(r),e?r.r:r.r-1)};L2.Ar.prototype.cov=function(r){if(arguments.length&&"n"!==r)throw new Error("argument must be 'n'");return o(this,r)},L2.Ar.prototype.cov.sig={arg:[1],rtn:!0,min:0,dim:0};var s=function(r){r instanceof L2.Ar||(r=new L2.ArJSA([r])),r=L2.tab(o(r));var e=r.diag()._map(L2.pf.ew.sqrt);return L2.symb.aa.apply("/",r,e.mm(new L2.ArTp(e)))};L2.Ar.prototype.corr=function(){return s(this)},L2.Ar.prototype.corr.sig={arg:[],rtn:!0,min:0,dim:0}}();
L2.aux.onLoad=function(e,t){t?document.addEventListener("DOMContentLoaded",e):window.addEventListener("load",e)},L2.aux.ajaxGet=function(e,t,r,n){var o=new XMLHttpRequest;o.responseType="text",o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status)throw new Error("status: "+o.status+(o.statusText?", "+o.statusText:""));t(o.responseText)}},o.open("GET",e,!0,r,n),o.send()},L2.aux.ajaxLoad=function(e,t,r,n){if(".L2T"!==e.slice(-4).toUpperCase())throw new Error("file extension must be '.L2T'");L2.aux.ajaxGet(e,function(e){t(L2.sc.deserial(e))},r,n)},L2.html=function(e){function t(e){if(!e.rk||1!==e.c||1!==e.p)throw new Error("dictionary expected");var t,r,n=new Array(2*e.v.length);for(var o in e.rk)t=e.rk[o],n[2*t]=o,r=e.v[t],n[2*t+1]=r instanceof L2.Box?r._contents_:r;return n}var r=function(){return"element list (internal type)"};r._html_={};var n=e.length;r._html_.size=n;var o=["id","innerHTML","outerHTML","scrollLeft","scrollTop"];return r._html_.setGen=function(i){var l,s,a,f,u,h=i[0];for(i=2===i.length?t(i[1]):i=i.slice(1),a=i.length,s=0;s<a;s+=2)switch(f=i[s],f instanceof L2.Ar&&(f=f.v[0]),u=i[s+1],h){case"setStyle":if(u instanceof L2.Ar)for(l=0;l<n;l++)e[l].style[f]=String(u.v[l%u.v.length]);else for(u=String(u),l=0;l<n;l++)e[l].style[f]=u;break;case"setProp":if(o.indexOf(f)===-1)throw new Error("invalid property: "+f);if(u instanceof L2.Ar)for(l=0;l<n;l++)e[l][f]=String(u.v[l%u.v.length]);else for(u=String(u),l=0;l<n;l++)e[l][f]=u;break;case"setAttr":if(u instanceof L2.Ar)for(l=0;l<n;l++)e[l].setAttribute(f,String(u.v[l%u.v.length]));else for(u=String(u),l=0;l<n;l++)e[l].setAttribute(f,u)}return r},r._html_.adjHTML=function(t,o){var i,l;if(o instanceof L2.Ar)for(l=o.v.length,i=0;i<n;i++)e[i].insertAdjacentHTML(t,o.v[i%l]);else for(i=0;i<n;i++)e[i].insertAdjacentHTML(t,o);return r},r._html_.remElm=function(){for(var t=0;t<n;t++)e[t].parentNode.removeChild(e[t]);return!0},r._html_.loop=function(t){for(var o=0;o<n;o++)t(L2.html([e[o]]),o,r);return r},r._html_.getGen=function(t,r){var o,i,l=new Array(n);switch(t){case"style":for(o=0;o<n;o++)l[o]=getComputedStyle(e[o]).getPropertyValue(r);break;case"prop":for(o=0;o<n;o++)l[o]=L2.aux.basicType(e[o][r]);break;case"attr":for(o=0;o<n;o++)l[o]=null===(i=e[o].getAttribute(r))?void 0:i;break;case"hasAttr":for(o=0;o<n;o++)l[o]=e[o].hasAttribute(r);break;case"hasClass":for(o=0;o<n;o++)l[o]=e[o].classList.contains(r)}return new L2.ArJSA(l)},r._html_.changeClass=function(t,o){var i,l,s;if(o instanceof L2.Ar)for(l=0,s=o.v.length;l<s;l++)for(i=0;i<n;i++)e[i].classList[t](o.v[l]);else for(i=0;i<n;i++)e[i].classList[t](o);return r},r._html_.remAttr=function(t){var o,i,l;if(t instanceof L2.Ar)for(i=0,l=t.v.length;i<l;i++)for(o=0;o<n;o++)e[o].removeAttribute(t.v[i]);else for(o=0;o<n;o++)e[o].removeAttribute(t);return r},r._html_.at=function(t){function r(e){if("number"!=typeof e)throw new Error("index must be a number");if(Math.round(e)!==e)throw new Error("integer expected");if(e<0&&(e=n+e),e>=n||e<0)throw new Error("index out of bounds");return e}var o,i,l;if(t instanceof L2.Ar){if(i=t.v.length,0===i)return L2.html([]);if(0===n)throw new Error("index out of bounds");for(l=new Array(i),o=0;o<i;o++)l[o]=r(t.v[o]);if(!L2.aux.uniqueJSA_strEq(l))throw new Error("repeated indices not allowed");for(o=0;o<i;o++)l[o]=e[l[o]];return L2.html(l)}return L2.html([e[r(t)]])},r._html_.on=function(t,o,i){var l,s,a;if("function"!=typeof o)throw new Error("function expected");for(s=function(e){o(L2.event(e))},l=0;l<n;l++)if(a=e[l],a.addEventListener(t,s),void 0!==i){if(a._L2listeners_)if(a._L2listeners_[t]){if(a._L2listeners_[t][i])throw a.removeEventListener(t,s),new Error("will result in duplicate name")}else a._L2listeners_[t]={};else a._L2listeners_={},a._L2listeners_[t]={};a._L2listeners_[t][i]=s}return r},r._html_.off=function(t,o){var i,l,s,a,f;for(i=0;i<n;i++)if(f=e[i],f._L2listeners_&&f._L2listeners_[t])if(a=f._L2listeners_[t],L2.ge.isNil(o)){for(l in a)f.removeEventListener(t,a[l]);delete f._L2listeners_[t]}else{if(o instanceof L2.Ar)for(l=0;l<o.v.length;l++)void 0!==o.v[l]&&(s=a[o.v[l]],s&&(f.removeEventListener(t,s),delete a[o.v[l]]));else s=a[o],s&&(f.removeEventListener(t,s),delete a[o]);0===Object.keys(a).length&&delete f._L2listeners_[t]}return r},r._html_.checkElmt=function(){for(var t=0;t<n;t++)if(null===e[t])throw new Error("HTML element expected");return r},r._html_._elmt=function(t){return e[t]},r},L2.html.fit=function(e,t,r){var n,o,i,l;if("string"!=typeof e)throw new Error("first argument must be a string");arguments.length>2&&L2.assert.func(r);var s=document.querySelectorAll(e);if(l=t.r-s.length,l<0){for(i=new Array(t.r),n=0;n<t.r;n++)i[n]=s[n];for(n=t.r,o=s.length;n<o;n++)s[n].parentNode.removeChild(s[n]);s=i}else if(l>0&&(r&&(r.length>1?r(l,t.slice("r",s.length,t.r-1)):r(l),s=document.querySelectorAll(e)),s.length!==t.r))throw new Error("number of elements must equal number of rows in data");return L2.html(s)},L2.html.idKey=function(e,t,r,n){var o,i,l,s,a,f,u,h,c,v,d,m=arguments.length;if("string"!=typeof e)throw new Error("first argument must be a string");if(!t.rk)throw new Error("second argument must have row keys");if(v=document.querySelectorAll(e),void 0!==r&&"function"!=typeof r)throw new Error("third argument must be undefined or a function");if(m>3&&"keep"!==n)throw new Error("fourth argument must be 'keep'");if(0===v.length){if(0===t.r)return L2.html(v);r&&(r.length>1?r(t.key("r"),t):r(t.key("r")))}else{if(0===t.r){if(!n)for(o=0,l=v.length;o<l;o++)v[o].parentNode.removeChild(v[o]);return L2.html([])}if(r){f={};for(o in t.rk)f[o]=t.rk[o];for(o=0,i=0,l=v.length;o<l;o++)if(s=v[o],s.hasAttribute("id")&&(a=s.getAttribute("id"))in f){if(++i===t.r)break;delete f[a]}if(i!==t.r){for(u=L2.aux.keyValFlip(f),h=Object.keys(u).sort(function(e,t){return e-t}),c=new Array(h.length),o=0,l=h.length;o<l;o++)c[o]=u[h[o]];c=new L2.ArJSA(c),r.length>1?r(c,t._oneDimAr("r",c)):r(c)}}}if(v=document.querySelectorAll(e),v.length<t.r)throw new Error("row key with no matching element id");f={};for(o in t.rk)f[o]=t.rk[o];for(d=new Array(t.r),o=0,i=0,l=v.length;o<l;o++)if(s=v[o],i===t.r){if(n)break;s.parentNode.removeChild(s)}else s.hasAttribute("id")&&(a=s.getAttribute("id"))in f?(d[f[a]]=s,++i,delete f[a]):n||s.parentNode.removeChild(s);if(i!==t.r)throw new Error("row key with no matching element id");return L2.html(d)},L2.event=function(e){var t=function(){return"event (internal type)"};return t._event_=e,t._event_.stop=function(t){var r,n;if(L2.ge.isNil(t))e.preventDefault(),e.stopPropagation();else if(t instanceof L2.Ar)for(var r=0;r<t.v.length;r++)if(n=t.v[r],"default"===n)e.preventDefault();else if("propagation"===n)e.stopPropagation();else{if("now"!==n)throw new Error("invalid value");e.stopImmediatePropagation()}else if("default"===t)e.preventDefault();else if("propagation"===t)e.stopPropagation();else{if("now"!==t)throw new Error("invalid value");e.stopImmediatePropagation()}},t};